<!DOCTYPE html>
<html lang="en">
<head>
    <html lang="en">
  <head>
    <title>
      Yet Another Guide to Working with EPO Patent Data
    </title>
    <meta charset='UTF-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name='author' content='Michael Wang Fei'>
    <meta name='keywords' content='
          machine learning,
          statistical machine learning,
          bayesian inference,
          statistics,
          computational statistics,
          linear algebra,
          numerical linear algebra,
          statistical software,
          deep learning,
          computer science,
          probability,
          math,
          mathematics,
          probabilistic reasoning
      '>
      <meta name='keywords' content='patent analytic, EPO, PATSTAT, USPTO'>
      <link rel="stylesheet" href="/css/blog.css">
      <link rel="stylesheet" href="/css/markdown.css">
      <link rel="stylesheet" href="/css/trac.css">
      <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
      <!-- The loading of KaTeX is deferred to speed up page rendering -->
      <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
      <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
      <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Yet Another Guide to Working with EPO Patent Data</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Yet Another Guide to Working with EPO Patent Data" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The first question came to my mind was “where should I start?” when I wanted to do patent analytics for my research project. Like everyone, I ended up with Google or ChatGPT (if you got a chance to ask there). I found out that the EPO Worldwide Patent Statistical Database (PATSTAT) is one of the most widely used patent databases for researchers and business analytics. Right now users could get access to PATSTAT online free for one month. Since most people need to use this database longer than one month, this guide will cover how you could access the PATSTAT database for free and use it whenever you want." />
<meta property="og:description" content="The first question came to my mind was “where should I start?” when I wanted to do patent analytics for my research project. Like everyone, I ended up with Google or ChatGPT (if you got a chance to ask there). I found out that the EPO Worldwide Patent Statistical Database (PATSTAT) is one of the most widely used patent databases for researchers and business analytics. Right now users could get access to PATSTAT online free for one month. Since most people need to use this database longer than one month, this guide will cover how you could access the PATSTAT database for free and use it whenever you want." />
<link rel="canonical" href="https://oceanumeric.github.io//blogs/guide-to-patent" />
<meta property="og:url" content="https://oceanumeric.github.io//blogs/guide-to-patent" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-02-06T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Yet Another Guide to Working with EPO Patent Data" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-02-06T00:00:00+00:00","datePublished":"2023-02-06T00:00:00+00:00","description":"The first question came to my mind was “where should I start?” when I wanted to do patent analytics for my research project. Like everyone, I ended up with Google or ChatGPT (if you got a chance to ask there). I found out that the EPO Worldwide Patent Statistical Database (PATSTAT) is one of the most widely used patent databases for researchers and business analytics. Right now users could get access to PATSTAT online free for one month. Since most people need to use this database longer than one month, this guide will cover how you could access the PATSTAT database for free and use it whenever you want.","headline":"Yet Another Guide to Working with EPO Patent Data","mainEntityOfPage":{"@type":"WebPage","@id":"https://oceanumeric.github.io//blogs/guide-to-patent"},"url":"https://oceanumeric.github.io//blogs/guide-to-patent"}</script>
<!-- End Jekyll SEO tag -->

  </head>
</html>


</head>
<body>
<div class='content'>
    <!DOCTYPE html>
<div class='nav'>
    <ul class='wrap'>
        <li><a href='/'>Home</a></li>
        <li><a href='/blog'>Blog</a></li>
        <li><a href='/math'>Math</a></li>
        <li><a href='/tags'>Tags</a></li>
    </ul>
</div>
</html>

    <div class='front-matter'>
        <div class='wrap'>
            <h1>Yet Another Guide to Working with EPO Patent Data</h1>
            <h4>It took me a while to get into patent analytics, which is a 'wild' world. I hope my guide for patent analytics could help you to navigate through.</h4>
            <div class='bylines'>
                <div class='byline'>
                    
                    
                        <span class="post-tags">
                            <i class="fa fa-tags"></i>
                            
                            <a href="/blog-tags/patent">patent</a>, 
                            
                            <a href="/blog-tags/patstat">patstat</a>, 
                            
                            <a href="/blog-tags/api">api</a>
                            
                        </span>
                    
                    <h3>Published</h3>
                    <p>06 February 2023</p>
                </div>
            </div>
            <div class='clear'></div>
        </div>
    </div>
    <div class='wrap article'>
        <p>The first question came to my mind was “<em>where should I start?</em>” when I
wanted to do patent analytics for my research project. Like everyone, I
ended up with Google or ChatGPT (if you got a chance to ask there). I found 
out that the EPO Worldwide Patent Statistical Database (<a href="https://www.epo.org/searching-for-patents/business/patstat.html" target="_blank">PATSTAT</a>)
is one of the most widely used patent databases for researchers and business
analytics. Right now users could get access to PATSTAT online free for one month.
Since most people need to use this database longer than one month,
this guide will cover how you could access the PATSTAT database for <strong>free</strong> and
use it whenever you want.</p>

<ul>
  <li><a href="#knowing-the-data">Knowing the data</a></li>
  <li><a href="#getting-the-dataset">Getting the dataset</a></li>
  <li><a href="#understanding-oecd-han-database-structure">Understanding OECD HAN database structure</a></li>
  <li><a href="#a-case-study-with-oecd-han-datasets">A case study with OECD HAN datasets</a>
    <ul>
      <li><a href="#read-the-dataset">Read the dataset</a></li>
      <li><a href="#search-for-granted-patents">Search for granted patents</a></li>
      <li><a href="#linked-open-ep-data">Linked open EP data</a></li>
    </ul>
  </li>
</ul>

<h2 id="knowing-the-data">Knowing the data</h2>

<p>Paper by <a class="citation" href="#kang2016patstat">(Kang &amp; Tarasconi, 2016)</a> presented the examples of frequently used patent
statistics in the following table.</p>

<div class="table-caption">
<span class="table-caption-label">Table 1.</span> What we can do with patent information <a class="citation" href="#kang2016patstat">(Kang &amp; Tarasconi, 2016)</a>. 
</div>

<table>
  <thead>
    <tr>
      <th>Analysis</th>
      <th>Patent statistics</th>
      <th>Purposes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Citation analysis</td>
      <td>Forward citations</td>
      <td>Measure technological value</td>
    </tr>
    <tr>
      <td> </td>
      <td>Backward citations</td>
      <td>Find knowledge source</td>
    </tr>
    <tr>
      <td>Patent counts analysis</td>
      <td>Patent counts</td>
      <td>Observe patent portfolio</td>
    </tr>
    <tr>
      <td> </td>
      <td>RTA (Revealed Technology Advance) PS (Patent Share)</td>
      <td>Identify core technological competence</td>
    </tr>
    <tr>
      <td>Technology class analysis</td>
      <td>Generality</td>
      <td>Measure endogenous applicability to different technological fields</td>
    </tr>
    <tr>
      <td> </td>
      <td>Originality</td>
      <td>Measure knowledge absorption from different technological fields</td>
    </tr>
    <tr>
      <td>Inventor analysis</td>
      <td>Inventor counts</td>
      <td>Measure invention quality Measure absorptive capability</td>
    </tr>
    <tr>
      <td> </td>
      <td>Inventor</td>
      <td>Identify specific inventors’ info such as star engineers Follow mobility of R&amp;D personnel</td>
    </tr>
  </tbody>
</table>

<p>In terms of discussed advantages and disadvantages of using PATSTAT data, they
made a summary as follows:</p>

<ul>
  <li>Advantage:
    <ul>
      <li>Databases based on and linkable to PATSTAT have been produced by other institutions</li>
      <li>In comparing the characteristics of PATSTAT with the NBER Patent Database of the US Patent data, PATSTAT provides information that are not available in the other two databases such as priority and continuing applications</li>
    </ul>
  </li>
  <li>Disadvantage:
    <ul>
      <li>There is a large proportion of missing information in inventors’ geographic data</li>
      <li>PATSTAT has a European-centered bias</li>
    </ul>
  </li>
</ul>

<p>There are three most critical issues that users must recognize when planning to use PATSTAT  <a class="citation" href="#kang2016patstat">(Kang &amp; Tarasconi, 2016)</a>:</p>

<ol>
  <li>Users need to harmonize names of applicants and inventors; for example, Toyota Motor Corporation appears as “Toyota Motor Corporation,” “Toyota Motor Co,” “Toyota Jidosha Kabushiki Kaisha” (“Jidosha” and “Kabushiki Kaisha” mean a car and a corporation in Japanese, respectively), “Toyota Jidosha K. K.,” and so on.</li>
  <li>Users need to be aware of the case that one entity can appear with different names in patent documents.</li>
  <li>Users need to understand how EPO records and tracks its documents, especially when those documents are from different patent offices, such as USPTO.</li>
</ol>

<p>With those background information, I believe you are well prepared to start working
with some datasets now.</p>

<h2 id="getting-the-dataset">Getting the dataset</h2>

<p>If you want to do some quick search, please try <a href="https://worldwide.espacenet.com/" target="_blank">Espacenet</a>,
which uses the same database with PATSTAT. However, as we have mentioned, there
are name issues in this database. Moreover, you cannot do multiple searches
by using <code class="language-plaintext highlighter-rouge">SQL</code>, <code class="language-plaintext highlighter-rouge">R</code> or <code class="language-plaintext highlighter-rouge">Python</code> with Espacenet. PATSTAT does support SQL queries
<a class="citation" href="#de2014introduction">(De Rassenfosse et al., 2014)</a>, but it is very time consuming to extract information
you want. So, where and how could get the dataset then?</p>

<p>The starting point is <a href="https://www.oecd.org/sti/inno/intellectual-property-statistics-and-analysis.htm" target="_blank">OECD Harmonized Applicant Names (HAN) Database</a>, which is free for non-commercial use after filling in 
a <a href="https://forms.office.com/pages/responsepage.aspx?id=1MdBrGEfDUaw9PySWitHHKuxmuqpz_9KusL7-G1D6wFUOEU0OVBYVk5QTzROVlBTSUtBUUREWVhHTiQlQCN0PWcu" target="_blank">short online form</a>.</p>

<p>The OECD HAN database provides a grouping of patent applicant’s names which has been elaborated
with business register data. The names of patent applicants were originally extracted from European Patent
Office’s (EPO) Worldwide Statistical Patent Database (PATSTAT, Spring 2022). The database also includes
the list of patent documents filed to the EPO, the US Patent and Trademarks Office (USPTO) or through the
Patent Co-operation Treaty (PCT).</p>

<p>Since applicants’ names could have some level of similairity  but still refers to the different entity (such as Volkswagen Group vs. Volkswagen Shanghai), we need to identify
those entities by matching the official business register database. OECD patent research group cleaned/harmonized names by matching against company
names from business register data - ORBIS database from Bureau van Dijk.</p>

<p>Sometimes, names have typos but computer could not identify those names as 
the same entity such as “Volksgen (missing ‘w’) Shanghai”. For cases like
this, we need to clean and harmonized names again.</p>

<p>Please read OECD’s <a href="/pdfs/OECD HAN Database - August 2022.pdf" target="_blank">methodology report</a> to know how they clean, harmonize and consolidate applicant
names.</p>

<h2 id="understanding-oecd-han-database-structure">Understanding OECD HAN database structure</h2>

<p>Figure 1 gives OECD HAN database structure (open the zoomed version 
with the new tab by right-click). It has four tables: <code class="language-plaintext highlighter-rouge">HAN_PERSON</code>, <code class="language-plaintext highlighter-rouge">HAN_NAMES</code>,
<code class="language-plaintext highlighter-rouge">HARM_NAMES</code>, and <code class="language-plaintext highlighter-rouge">HAN_PATENTS</code>. We will use one patent file as an example to
walk through those tables. Notice that there are around 18 million rows in
<code class="language-plaintext highlighter-rouge">HAN_PATENTS</code> table, which accounts for around 18% of EPO’s total patent document.<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup>
This means the OECD HAN database has a European-centered bias. This is partly
due to the useage of ORBIS database in the matching process,  which has more register information for European firms.
We will discuss how to get and analyze patent data for Chinese firms in the
coming sections of this post.</p>

<div class="figure">
    <img src="/images/blog/oecd-han-database.png" alt="OECD HAN database illustration" style="width: 100%; display: block; margin: 0 auto;" />
    <div class="caption">
        <span class="caption-label">Figure 1.</span> OECD HAN database structure:
        there are four tables, in which HAN_PERSON is the correspondence
        table which include all cleaned names.
    </div>
</div>

<p>Now, we chose the first six records (or entries) from <code class="language-plaintext highlighter-rouge">HAN_PATENTS</code> table and search
those patents from EPO’s <a href="https://worldwide.espacenet.com/?locale=en_EP" target="_blank">Espacenet</a>.
In the <code class="language-plaintext highlighter-rouge">HAN_PATENTS</code> table, the variable <code class="language-plaintext highlighter-rouge">Appln_id</code> refers to the patent application
identifier in PATSTAT database. You can use it to retreat the document if you
can access to PATSTAT database. When we search in Espacenet, we use <code class="language-plaintext highlighter-rouge">Patent_number</code>
instead of <code class="language-plaintext highlighter-rouge">Appln_id</code>.</p>

<div class="table-caption">
<span class="table-caption-label">Table 2.</span> First six rows of HAN_PATENTS, which starts at HAN_ID = 4. 
</div>

<table>
  <thead>
    <tr>
      <th>HAN_ID <int></int></th>
      <th>HARM_ID <int></int></th>
      <th>Appln_id <int></int></th>
      <th>Publn_auth <chr></chr></th>
      <th>Patent_number <chr></chr></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>4</td>
      <td>4</td>
      <td>311606173</td>
      <td>US</td>
      <td>US8668089</td>
    </tr>
    <tr>
      <td>7</td>
      <td>7</td>
      <td>439191607</td>
      <td>US</td>
      <td>US9409947</td>
    </tr>
    <tr>
      <td>7</td>
      <td>7</td>
      <td>518367793</td>
      <td>US</td>
      <td>US10836794</td>
    </tr>
    <tr>
      <td>10</td>
      <td>10</td>
      <td>365204276</td>
      <td>US</td>
      <td>US8513480</td>
    </tr>
    <tr>
      <td>14</td>
      <td>14</td>
      <td>336903179</td>
      <td>WO</td>
      <td>WO2011112122</td>
    </tr>
    <tr>
      <td>14</td>
      <td>14</td>
      <td>363622722</td>
      <td>WO</td>
      <td>WO2012064218</td>
    </tr>
  </tbody>
</table>

<p>Let’s search for <code class="language-plaintext highlighter-rouge">US8668089</code> - the first entry with <code class="language-plaintext highlighter-rouge">HAN_ID=4</code>.
The following search result was returned by Espacenet.</p>

<div class="figure">
    <img src="/images/blog/US8668089.png" alt="Searching results for US8668089" style="width: 100%; display: block; margin: 0 auto;" />
    <div class="caption">
        <span class="caption-label">Figure 2.</span> Espacenet's searching
        returned result that includes patent name, inventor, applicant, CPC classes,
        and publication information and priority date. 
    </div>
</div>

<p>To understand meaning of those dates, code and numbers, we need to learn some
legal terms in the field of patent analytics.</p>

<ul>
  <li>
    <p>Patent <strong>application</strong>:  The <strong>formal “paperwork”</strong> filed by an applicant, 
(or by a patent attorney or patent agent on the applicant’s behalf)
seeking to obtain a patent for a specific invention. There are
several parts to a patent application, for example the
description and the claims. In the above example, the patent file called 
<em>System Crate, in Particular for Transporting Fresh Fish</em> is the formal ‘paperwork’.</p>
  </li>
  <li>Patent <strong>priority</strong>:  The priority date is the first date of filing of a 
patent application. It is essential for determining whether any subsequent application for the
same invention can still be assessed as novel. It also makes it possible to
determine whether the subject-matter of a patent application is prior art
on a particular date. The priority date is, however, not necessarily the same as the filing date.
    <ul>
      <li>in our case, the priority date is <strong>2006-05-29</strong>.</li>
      <li>if another firm filed the patent application with the similar idea later than 2006-05-29, the subsequent
  application will be assessed as non-novel.</li>
      <li>understanding priority and prior arts can be tricky, please read my conversation with 
  <a href="https://oceanumeric.github.io/blogs/talk-with-chatGPT-about-patent" target="_blank">ChatGPT</a>.</li>
    </ul>
  </li>
  <li>
    <p>Patent <strong>publication</strong>: The first patent publication is often 
the <strong>published patent application</strong>, EPO offices published the patent file 
to the public 18 months after a priority date. USPTO has different rules.
In this example, the publication date is 2010-04-22 (that’s why publication
number starts <code class="language-plaintext highlighter-rouge">US2010....(A1)</code>) The code <code class="language-plaintext highlighter-rouge">A1</code> in the publication number refers to patent application publication kind.
Sometimes, firms might update the application and they will republish it again
with the same name, then A2 will be used in the publication code. Those kind code
(as explained in the next bullet point) have slight different meanings
in different patent office (but ideas behind those code are same).</p>
  </li>
  <li>Patent publication <strong>kind code</strong>: A code which includes 1 or 2 letters and in many cases a
number, used to distinguish the kind of published patent
document. For example, the publication of an application used in EPO for a
patent with or without a search report, and the level of the
publication:
    <ul>
      <li>A1: European patent application published with European search report</li>
      <li>A2: European patent application published without European search report (search report not available at publication date)</li>
      <li>A3: document Separate publication of the European search report</li>
      <li>A4: document Supplementary search report</li>
      <li>B1: European patent specification (granted patent)</li>
      <li>B2: New European patent specification (amended specification after opposition procedure)</li>
    </ul>
  </li>
  <li>
    <p>Patent application <strong>claims</strong>: The part of the patent that defines the scope of the legal
protection sought for the invention.</p>
  </li>
  <li>
    <p>Patent <strong>granted</strong>: the patent was granted on 2014-03-11 for our example
<em>System Crate, in Particular for Transporting Fresh Fish</em>, with a new 
document number <code class="language-plaintext highlighter-rouge">US8668089 (B2)</code>.</p>
  </li>
  <li>
    <p>Patent <strong>citation(s)</strong>: A patent document cited. Citations are not only added by the
patent applicant but also by the examiners of the patent
application. Patents citations may be added during the
different steps of the granting process (search report,
examination, third party observations, opposition) and thus
added to the patent data.</p>
  </li>
  <li>
    <p>Simple patent <strong>family</strong>: All documents sharing exactly the same set of priorities.</p>
  </li>
  <li>Patent <strong>family</strong>: All documents sharing directly or indirectly at least one
priority.</li>
</ul>

<p>One has to be very <strong>careful</strong> when you are working with patent data because 
you might have different <em>reference IDs</em> pointing to the same patent. Therefore,
it is better to work only on granted patents unless you want to do patent
analysis based on application documents. Having a grip on it by looking
at the Figure 3.</p>

<div class="figure">
    <img src="/images/blog/patent-search-illustration.webp" alt="Searching results illustated for US8668089" style="width: 80%; display: block; margin: 0 auto;" />
    <div class="caption">
        <span class="caption-label">Figure 3.</span> The complexity of
        a patent file; read the granted patent file <a href="/pdfs/US_8668089_B2.pdf" target="_blank">[pdf]</a>
        to have a big picture of this patent file.
    </div>
</div>

<p>It makes sense for a firm to file a patent in different judicial offices, therefore
you see the patent in Figure 3 with publication number US2010096288(A1) was granted
in different offices and then different document numbers such as <code class="language-plaintext highlighter-rouge">US8668089(B2)</code>,
<code class="language-plaintext highlighter-rouge">EP2024242(B1)</code>. This might lead to the issue of overcounting patents if we
do not search cautiously.</p>

<p>Let’s review the first from <code class="language-plaintext highlighter-rouge">HAN_PATENTS</code>, which we have extracted the
patent document for the first entry with patent number of <code class="language-plaintext highlighter-rouge">US8668089</code>. Notice that the starting entry in <code class="language-plaintext highlighter-rouge">HAN_PATENTs</code> table is at <code class="language-plaintext highlighter-rouge">HAN_ID=4</code> 
instead of 1, this means for companies with <code class="language-plaintext highlighter-rouge">HAN_ID=1</code> (or 2-3), 
there is no patent information for them.</p>

<table>
  <thead>
    <tr>
      <th>HAN_ID <int></int></th>
      <th>HARM_ID <int></int></th>
      <th>Appln_id <int></int></th>
      <th>Publn_auth <chr></chr></th>
      <th>Patent_number <chr></chr></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>4</strong></td>
      <td>4</td>
      <td>311606173</td>
      <td>US</td>
      <td><strong>US8668089</strong></td>
    </tr>
  </tbody>
</table>

<p>Table 3 presents the first seven rows of <code class="language-plaintext highlighter-rouge">HAN_PERSON</code>. Compared with Table 2,
it starts at <code class="language-plaintext highlighter-rouge">HAN_ID=1</code>, this means some names picked by algorithms do not have
patent files even though they have unique person IDs. In this table, <code class="language-plaintext highlighter-rouge">Person_id</code>
refers to applicant’s unique identifier from PATSTAT. This table is of little
misleading as many of them are firms’ names. So, be aware that <code class="language-plaintext highlighter-rouge">Person_name_clean</code>
refers to the harmonised applicant name.</p>

<div class="table-caption">
<span class="table-caption-label">Table 3.</span> First seven rows of HAN_PERSON, which starts at HAN_ID = 1. 
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">HAN_ID</th>
      <th style="text-align: center">HARM_ID</th>
      <th style="text-align: center">Person_id</th>
      <th style="text-align: right">Person_name_clean</th>
      <th style="text-align: center">Person_ctry_code</th>
      <th style="text-align: center">Matched</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><int></int></td>
      <td style="text-align: center"><int></int></td>
      <td style="text-align: center"><int></int></td>
      <td style="text-align: right"><chr></chr></td>
      <td style="text-align: center"><chr></chr></td>
      <td style="text-align: center"><int></int></td>
    </tr>
    <tr>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">15164069</td>
      <td style="text-align: right">&amp; HAMBOURG NIENDORF</td>
      <td style="text-align: center">DE</td>
      <td style="text-align: center">0</td>
    </tr>
    <tr>
      <td style="text-align: center">2</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">30816597</td>
      <td style="text-align: right">&amp; KK</td>
      <td style="text-align: center">JP</td>
      <td style="text-align: center">0</td>
    </tr>
    <tr>
      <td style="text-align: center">3</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">67383967</td>
      <td style="text-align: right">“ASTRONIT” CLOSE CORP</td>
      <td style="text-align: center">RU</td>
      <td style="text-align: center">0</td>
    </tr>
    <tr>
      <td style="text-align: center">3</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">47772459</td>
      <td style="text-align: right">“ASTRONIT” CLOSE CORP</td>
      <td style="text-align: center">RU</td>
      <td style="text-align: center">0</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>4</strong></td>
      <td style="text-align: center">4</td>
      <td style="text-align: center"><strong>47210990</strong></td>
      <td style="text-align: right"><strong>“DEUTSCHE SEE” GMBH</strong></td>
      <td style="text-align: center"><strong>DE</strong></td>
      <td style="text-align: center">0</td>
    </tr>
    <tr>
      <td style="text-align: center">5</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">47367244</td>
      <td style="text-align: right">“EFIRNOIE” OPEN JOINT STOCK CO</td>
      <td style="text-align: center">RU</td>
      <td style="text-align: center">0</td>
    </tr>
    <tr>
      <td style="text-align: center">5</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">64495153</td>
      <td style="text-align: right">“EFIRNOIE” OPEN JOINT STOCK CO</td>
      <td style="text-align: center">RU</td>
      <td style="text-align: center">0</td>
    </tr>
  </tbody>
</table>

<p>For the first four rows,
here are possible reasons why they are included in Table 3 but not in Table 2:</p>

<ul>
  <li><em>HAMBOURG NIENDORF</em> is a place, somehow PATSTAT identifies it as applicant; this
might be due to the misspecification of software or human beings; for instance, somehow 
a name of place was filled or saved in the place setted for applicant.</li>
  <li><em>&amp;KK</em>, this misspecification is very likely caused by the algorithm which might treat
any strings after <code class="language-plaintext highlighter-rouge">&amp;</code> as a name</li>
  <li><em>“ASTRONIT” CLOSE CORP</em>, this one has two different <code class="language-plaintext highlighter-rouge">Person_id</code> but same <code class="language-plaintext highlighter-rouge">HAN_ID</code>
because the name is same but applicant identifiers are different.</li>
</ul>

<p><strong>Differences between <code class="language-plaintext highlighter-rouge">HAN_ID</code> and <code class="language-plaintext highlighter-rouge">HARM_ID</code></strong>. In Table 4, we have selected four names with same <code class="language-plaintext highlighter-rouge">HAN_ID</code> but different <code class="language-plaintext highlighter-rouge">HARM_ID</code>s. This shows that <code class="language-plaintext highlighter-rouge">HAN_ID</code> was
grouped based on further harmonized process. Clearly, <em>“PERMNEFTEMASHREMONT” PUBLIC JOINT STOCK CO</em> is very likely to referring the same entity with <em>PUBLIC JOINT STOCK CO “PERMNEFTEMASHREMONT”</em>.</p>

<div class="table-caption">
<span class="table-caption-label">Table 4.</span> The selected rows from `HAN_PERSON`
database. 
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">HAN_ID</th>
      <th style="text-align: center">HARM_ID</th>
      <th style="text-align: center">Person_id</th>
      <th style="text-align: right">Person_name_clean</th>
      <th style="text-align: center">Person_ctry_code</th>
      <th style="text-align: center">Matched</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><int></int></td>
      <td style="text-align: center"><int></int></td>
      <td style="text-align: center"><int></int></td>
      <td style="text-align: right"><chr></chr></td>
      <td style="text-align: center"><chr></chr></td>
      <td style="text-align: center"><int></int></td>
    </tr>
    <tr>
      <td style="text-align: center">6</td>
      <td style="text-align: center">6</td>
      <td style="text-align: center">67613311</td>
      <td style="text-align: right">“EUROSTANDART” LTD LIABILITY CO</td>
      <td style="text-align: center">RU</td>
      <td style="text-align: center">0</td>
    </tr>
    <tr>
      <td style="text-align: center">7</td>
      <td style="text-align: center">7</td>
      <td style="text-align: center">53655360</td>
      <td style="text-align: right">“IVIX” LTD</td>
      <td style="text-align: center">RU</td>
      <td style="text-align: center">0</td>
    </tr>
    <tr>
      <td style="text-align: center">8</td>
      <td style="text-align: center">8</td>
      <td style="text-align: center">48761393</td>
      <td style="text-align: right">“PERMNEFTEMASHREMONT” PUBLIC JOINT STOCK CO</td>
      <td style="text-align: center">RU</td>
      <td style="text-align: center">1</td>
    </tr>
    <tr>
      <td style="text-align: center">8</td>
      <td style="text-align: center">8</td>
      <td style="text-align: center">64875050</td>
      <td style="text-align: right">“PERMNEFTEMASHREMONT” PUBLIC JOINT STOCK CO</td>
      <td style="text-align: center">RU</td>
      <td style="text-align: center">1</td>
    </tr>
    <tr>
      <td style="text-align: center">8</td>
      <td style="text-align: center">2462366</td>
      <td style="text-align: center">48754911</td>
      <td style="text-align: right">PUBLIC JOINT STOCK CO “PERMNEFTEMASHREMONT”</td>
      <td style="text-align: center">RU</td>
      <td style="text-align: center">1</td>
    </tr>
    <tr>
      <td style="text-align: center">8</td>
      <td style="text-align: center">2462366</td>
      <td style="text-align: center">64543597</td>
      <td style="text-align: right">PUBLIC JOINT STOCK CO “PERMNEFTEMASHREMONT”</td>
      <td style="text-align: center">RU</td>
      <td style="text-align: center">1</td>
    </tr>
  </tbody>
</table>

<p>In the next section, we will do a case study to link a small dataset with
OECD HAN datasets and try to answer some interesting analytical questions.</p>

<h2 id="a-case-study-with-oecd-han-datasets">A case study with OECD HAN datasets</h2>

<p>From now on, we will only work on three datasets: <code class="language-plaintext highlighter-rouge">HAN_NAMES</code>, <code class="language-plaintext highlighter-rouge">HAN_PERSON</code> and <code class="language-plaintext highlighter-rouge">HAN_PATENTS</code>
as those two datasets include all information we need. With those two datasets
we will try to do patent analysis for some german firms from information 
and communication technology industry. Here are components of this case
study:</p>

<ul>
  <li>Inputs:
    <ul>
      <li>dataset 1: a sample of German firms, size <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>246</mn></mrow><annotation encoding="application/x-tex">N=246</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">4</span><span class="mord">6</span></span></span></span></li>
      <li>dataset 2: <code class="language-plaintext highlighter-rouge">HAN_NAMES</code>, size <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>4</mn><mo separator="true">,</mo><mn>191</mn><mo separator="true">,</mo><mn>007</mn></mrow><annotation encoding="application/x-tex">N=4,191,007</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">9</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mord">0</span><span class="mord">7</span></span></span></span></li>
      <li>dataset 3: <code class="language-plaintext highlighter-rouge">HAN_PATENTS</code>, size <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>18</mn><mo separator="true">,</mo><mn>355</mn><mo separator="true">,</mo><mn>687</mn></mrow><annotation encoding="application/x-tex">N=18,355,687</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mord">5</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">6</span><span class="mord">8</span><span class="mord">7</span></span></span></span></li>
    </ul>
  </li>
  <li>Goal:
    <ul>
      <li>match names of those german firms with <code class="language-plaintext highlighter-rouge">HAN_NAMES</code> and then find their 
  <em>granted</em> patents from <code class="language-plaintext highlighter-rouge">HAN_PATENTS</code><sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup></li>
    </ul>
  </li>
  <li>Actions:
    <ul>
      <li>read dataset 1 and 2</li>
      <li>try to find out whether firms from dataset 1 are included in dataset 2 or not</li>
      <li>if it was included, then use <code class="language-plaintext highlighter-rouge">HAN_ID</code> to extract patents for corresponding firms
  from dataset 3</li>
    </ul>
  </li>
  <li>Outcomes:
    <ul>
      <li>a patent analytical report</li>
    </ul>
  </li>
</ul>

<h3 id="read-the-dataset">Read the dataset</h3>

<p>Table 5 gives the top rows of our dataset <code class="language-plaintext highlighter-rouge">german_firms.csv</code>, which
has firms’ native names and international names. We will use the column
of <code class="language-plaintext highlighter-rouge">name_international</code> as native names might have special german 
characters like ö or ü.</p>

<div class="table-caption">
<span class="table-caption-label">Table 5.</span> Top rows
of German firms dataset.
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">name_native</th>
      <th style="text-align: center">name_international</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Airbus Defence and Space GmbH</td>
      <td style="text-align: center">Airbus Defence and Space GmbH</td>
    </tr>
    <tr>
      <td style="text-align: center">EurA AG</td>
      <td style="text-align: center">EurA AG</td>
    </tr>
    <tr>
      <td style="text-align: center">TuTech Innovation GmbH</td>
      <td style="text-align: center">TuTech Innovation GmbH</td>
    </tr>
    <tr>
      <td style="text-align: center">FFT Produktionssysteme GmbH &amp; Co. KG.</td>
      <td style="text-align: center">FFT Produktionssysteme GmbH &amp; Co. KG.</td>
    </tr>
    <tr>
      <td style="text-align: center">Diehl Aviation Laupheim GmbH</td>
      <td style="text-align: center">Diehl Aviation Laupheim GmbH</td>
    </tr>
  </tbody>
</table>

<p>Table 6 gives the top rows of <code class="language-plaintext highlighter-rouge">HAN_NAMES</code>. Our goal is to extract
<code class="language-plaintext highlighter-rouge">HAN_ID</code> based on the value of <code class="language-plaintext highlighter-rouge">Clean_name</code>. For instance, we
will try to find <code class="language-plaintext highlighter-rouge">Airbus Defence and Space GmbH</code> in <code class="language-plaintext highlighter-rouge">HAN_NAMES</code>.</p>

<div class="table-caption">
<span class="table-caption-label">Table 6.</span> Top rows
of `HAN_NAMES`.
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">HAN_ID</th>
      <th style="text-align: center">Clean_name</th>
      <th style="text-align: center">Person_ctry_code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">1</td>
      <td style="text-align: center">&amp; HAMBOURG NIENDORF</td>
      <td style="text-align: center">DE</td>
    </tr>
    <tr>
      <td style="text-align: center">2</td>
      <td style="text-align: center">&amp; KK</td>
      <td style="text-align: center">JP</td>
    </tr>
    <tr>
      <td style="text-align: center">3</td>
      <td style="text-align: center">“ASTRONIT” CLOSE CORP</td>
      <td style="text-align: center">RU</td>
    </tr>
    <tr>
      <td style="text-align: center">4</td>
      <td style="text-align: center">“DEUTSCHE SEE” GMBH</td>
      <td style="text-align: center">DE</td>
    </tr>
    <tr>
      <td style="text-align: center">5</td>
      <td style="text-align: center">“EFIRNOIE” OPEN JOINT STOCK CO</td>
      <td style="text-align: center">RU</td>
    </tr>
  </tbody>
</table>

<p>Notice that all names in <code class="language-plaintext highlighter-rouge">HAN_PATENTS</code> are of upper case, we need
to convert our german firms’ names into upper cases too. Then 
we can do our query.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Code Block 1. query names in han_names </span><span class="w">
</span><span class="n">airbus</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">toupper</span><span class="p">(</span><span class="s1">'Airbus Defence and Space GmbH'</span><span class="p">)</span><span class="w">
</span><span class="n">han_names</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">Clean_name</span><span class="w"> </span><span class="o">%like%</span><span class="w"> </span><span class="n">airbus</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p>The above code returns nothing as we could not find the <em>exact</em> match.
Therefore, we need to query with less characters.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Code Block 2. query names in han_names with less characters   </span><span class="w">
</span><span class="n">airbus</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">toupper</span><span class="p">(</span><span class="s1">'Airbus Defence'</span><span class="p">)</span><span class="w">
</span><span class="n">han_names</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">Clean_name</span><span class="w"> </span><span class="o">%like%</span><span class="w"> </span><span class="n">airbus</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p>When we query with <code class="language-plaintext highlighter-rouge">AIRBUS DEFENCE</code>, we got more than 10 results shown in Table 7. This shows the challenging part of doing patent analysis<sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">3</a></sup>. Have a look at the one with <code class="language-plaintext highlighter-rouge">HAN_ID=62422</code>, you will realize that why we could not find anything when we use <code class="language-plaintext highlighter-rouge">'AIRBUS DEFENCE AND SPACE GMBH'</code> to do query because there is no ‘<em>AND</em>’ but
an ‘<em>ANG</em>’. Moreover, we have same firm registered in different
countries.</p>

<div class="table-caption">
<span class="table-caption-label">Table 7.</span> The results of the above query
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">HAN_ID</th>
      <th style="text-align: left">Clean_name</th>
      <th style="text-align: center">Person_ctry_code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">53993</td>
      <td style="text-align: left">AIRBUS DEFENCE &amp; SPACE</td>
      <td style="text-align: center">FR</td>
    </tr>
    <tr>
      <td style="text-align: center">60513</td>
      <td style="text-align: left">AIRBUS DEFENCE &amp; SPACE GMBH</td>
      <td style="text-align: center">DE</td>
    </tr>
    <tr>
      <td style="text-align: center">60514</td>
      <td style="text-align: left">AIRBUS DEFENCE &amp; SPACE LTD</td>
      <td style="text-align: center">GB</td>
    </tr>
    <tr>
      <td style="text-align: center">61747</td>
      <td style="text-align: left">AIRBUS DEFENCE &amp; SPACE GMBH</td>
      <td style="text-align: center">DD</td>
    </tr>
    <tr>
      <td style="text-align: center">61749</td>
      <td style="text-align: left">AIRBUS DEFENCE &amp; SPACE SAS</td>
      <td style="text-align: center">FR</td>
    </tr>
    <tr>
      <td style="text-align: center">62421</td>
      <td style="text-align: left">AIRBUS DEFENCE &amp; SPACE LTD</td>
      <td style="text-align: center">FI</td>
    </tr>
    <tr>
      <td style="text-align: center"><em>62422</em></td>
      <td style="text-align: left"><em>AIRBUS DEFENCE ANG SPACE GMBH</em></td>
      <td style="text-align: center"><em>DE</em></td>
    </tr>
    <tr>
      <td style="text-align: center">68676</td>
      <td style="text-align: left">AIRBUS DEFENCE &amp; SPACE GMBH</td>
      <td style="text-align: center">GB</td>
    </tr>
    <tr>
      <td style="text-align: center">81263</td>
      <td style="text-align: left">AIRBUS DEFENCE &amp; SPACE NETHERLANDS BV</td>
      <td style="text-align: center">NL</td>
    </tr>
    <tr>
      <td style="text-align: center">3637004</td>
      <td style="text-align: left">AIRBUS DEFENCE &amp; SPACE</td>
      <td style="text-align: center">DE</td>
    </tr>
    <tr>
      <td style="text-align: center">4401227</td>
      <td style="text-align: left">AIRBUS DEFENCE ANS SPACE GMBH</td>
      <td style="text-align: center">DE</td>
    </tr>
    <tr>
      <td style="text-align: center">4527012</td>
      <td style="text-align: left">AIRBUS DEFENCE &amp; AIR SPACE GMBH</td>
      <td style="text-align: center">DE</td>
    </tr>
  </tbody>
</table>

<p>Since we only want German firms, we will query with the
extra row filter by setting <code class="language-plaintext highlighter-rouge">Person_ctry_code == 'DE'</code>. This
gives us the following results, which means we will use all 
those five <code class="language-plaintext highlighter-rouge">HAN_IDs</code> to extract patent information for Airbus Defence and Space GmbH.</p>

<div class="table-caption">
<span class="table-caption-label">Table 8.</span> The results for querying German firms
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">HAN_ID</th>
      <th style="text-align: left">Clean_name</th>
      <th style="text-align: center">Person_ctry_code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">60513</td>
      <td style="text-align: left">AIRBUS DEFENCE &amp; SPACE GMBH</td>
      <td style="text-align: center">DE</td>
    </tr>
    <tr>
      <td style="text-align: center">62422</td>
      <td style="text-align: left">AIRBUS DEFENCE ANG SPACE GMBH</td>
      <td style="text-align: center">DE</td>
    </tr>
    <tr>
      <td style="text-align: center">3637004</td>
      <td style="text-align: left">AIRBUS DEFENCE &amp; SPACE</td>
      <td style="text-align: center">DE</td>
    </tr>
    <tr>
      <td style="text-align: center">4401227</td>
      <td style="text-align: left">AIRBUS DEFENCE ANS SPACE GMBH</td>
      <td style="text-align: center">DE</td>
    </tr>
    <tr>
      <td style="text-align: center">4527012</td>
      <td style="text-align: left">AIRBUS DEFENCE &amp; AIR SPACE GMBH</td>
      <td style="text-align: center">DE</td>
    </tr>
  </tbody>
</table>

<p>By the way, thought I like <code class="language-plaintext highlighter-rouge">Python</code> a lot, I have to admit that
the workflow of doing data analysis with packages like <code class="language-plaintext highlighter-rouge">data.table</code>
or <code class="language-plaintext highlighter-rouge">tidyverse</code> is much better in <code class="language-plaintext highlighter-rouge">R</code> community when your dataset is quite organized
and cleaned. The pipe function <code class="language-plaintext highlighter-rouge">%&gt;%</code> is one of my favorite.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Code-Block 3. Filter and extract han_ids for Airbus Defence</span><span class="w">
</span><span class="n">airbus</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">toupper</span><span class="p">(</span><span class="s1">'Airbus Defence'</span><span class="p">)</span><span class="w">
</span><span class="n">han_names</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">Person_ctry_code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'DE'</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">Clean_name</span><span class="w"> </span><span class="o">%like%</span><span class="w"> </span><span class="n">airbus</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="n">HAN_ID</span><span class="p">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">airbus_han_ids</span><span class="w">
</span><span class="n">airbus_han_ids</span><span class="w">
</span><span class="c1">#[1] 60513 62422 3637004 4401227 4527012</span><span class="w">

</span><span class="c1"># Code-Block 4. Count patents for different offices </span><span class="w">
</span><span class="n">han_patents</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">HAN_ID</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">airbus_han_ids</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">.N</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">=</span><span class="n">Publn_auth</span><span class="p">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">foo</span><span class="w">
    </span><span class="n">transform</span><span class="p">(</span><span class="n">adorn_totals</span><span class="p">(</span><span class="n">foo</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">transpose</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">row_to_names</span><span class="p">(</span><span class="n">row_number</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>With the <code class="language-plaintext highlighter-rouge">airbus_han_ids</code>, we will extract patents from <code class="language-plaintext highlighter-rouge">HAN_PATENTS</code> dataset. Then we found 1219 patent documents which are applied in 
different countries. When we use patent counting to measure how innovative of a firm is, we should be aware of the 
issue of over counting <a class="citation" href="#webb2005analysing">(Webb et al., 2005)</a>.</p>

<div class="table-caption">
<span class="table-caption-label">Table 9.</span> Patent distribution for Airbus Defence (DE)
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Office</th>
      <th style="text-align: center">EP</th>
      <th style="text-align: center">US</th>
      <th style="text-align: center">WO</th>
      <th>total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Number</td>
      <td style="text-align: center">716</td>
      <td style="text-align: center">415</td>
      <td style="text-align: center">88</td>
      <td>1219</td>
    </tr>
  </tbody>
</table>

<p><strong>Over counted or under counted?</strong> In total, we got 1219 patent documents from different patent offices.
However, the same patent could be filed in different offices. In our 
case, we need to check whether there are duplicates for our entity -
<em>AIRBUS DEFENCE AND SPACE GMBH</em>. For instance, among 1219 patents,
document <code class="language-plaintext highlighter-rouge">US2017113777</code> refers to the patent application document
that the firm filed in USPTO whereas document <code class="language-plaintext highlighter-rouge">EP3162699</code> refers to
the <strong>same</strong> patent application file and granted patent document by EPO. However,
both patent documents are recorded in <code class="language-plaintext highlighter-rouge">HAN_PATENTS</code> dataset.</p>

<div class="table-caption">
<span class="table-caption-label">Table 10.</span> Some of duplicated patents 
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">HAN_ID</th>
      <th style="text-align: center">HARM_ID</th>
      <th style="text-align: center">Appln_id</th>
      <th style="text-align: center">Publn_auth</th>
      <th style="text-align: center">Patent_number</th>
      <th style="text-align: center">Search_link</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">470692725</td>
      <td style="text-align: center">EP</td>
      <td style="text-align: center">EP3162699</td>
      <td style="text-align: center"><a href="https://worldwide.espacenet.com/searchResults?query=EP+3162699+B1" target="_blank">Espacenet</a></td>
    </tr>
    <tr>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">477856200</td>
      <td style="text-align: center">US</td>
      <td style="text-align: center">US2017113777</td>
      <td style="text-align: center"><a href="https://worldwide.espacenet.com/searchResults?ST=singleline&amp;locale=en_EP&amp;submitted=true&amp;DB=&amp;query=US2017113777%0D%0A" target="_blank">Espacenet</a></td>
    </tr>
  </tbody>
</table>

<p>Table 10 only shows two of those duplicates, there might be more. However,
it is not practical to go through all those patent numbers and search them
one by one and then check whether there are some duplicates or not. For now,
we will only use patents from EPO. This should be a safe choice as EPO
normally grant less patents with stricter rules (see group 1 in Table 11).</p>

<div class="table-caption">
<span class="table-caption-label">Table 11.</span> Some of duplicated patents with kind code 
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">HAN_ID</th>
      <th style="text-align: center">Publn_auth</th>
      <th style="text-align: center">Patent_number</th>
      <th style="text-align: left">Kind_code</th>
      <th style="text-align: center">Group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">US</td>
      <td style="text-align: center">US9308691</td>
      <td style="text-align: left">B2 (granted)</td>
      <td style="text-align: center">1</td>
    </tr>
    <tr>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">EP</td>
      <td style="text-align: center">EP2689872</td>
      <td style="text-align: left">A3 (application+search report)</td>
      <td style="text-align: center">1</td>
    </tr>
    <tr>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">US</td>
      <td style="text-align: center">US10703486</td>
      <td style="text-align: left">B2 (granted)</td>
      <td style="text-align: center">2</td>
    </tr>
    <tr>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">EP</td>
      <td style="text-align: center">EP3219614</td>
      <td style="text-align: left">B1 (granted)</td>
      <td style="text-align: center">2</td>
    </tr>
    <tr>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">US</td>
      <td style="text-align: center">US2017165795</td>
      <td style="text-align: left">A1 (application)</td>
      <td style="text-align: center">3</td>
    </tr>
    <tr>
      <td style="text-align: center">Not in the database</td>
      <td style="text-align: center">EP</td>
      <td style="text-align: center">EP3181711</td>
      <td style="text-align: left">B1 (granted)</td>
      <td style="text-align: center">3</td>
    </tr>
  </tbody>
</table>

<p>For our patent analysis, we need to make sure:</p>
<ul>
  <li>within one patent office (say EPO):
    <ul>
      <li>patents are not over counted</li>
      <li>patents are not under counted</li>
    </ul>
  </li>
  <li>across patent offices (say USPTO and EPO):
    <ul>
      <li>patents are not over counted</li>
      <li>patents are not under counted</li>
    </ul>
  </li>
</ul>

<p>If we only use patents from EPO, patents might be under counted overall as it
is possible that firms got granted patents from USPTO but did not filed patent application to EPO or applied but rejected. With all those trade-offs, the best decision 
is to be of under counted rather than over counted.</p>

<p>In Table 11, there is one entry marked as ‘Not in the database’, this shows
the bias<sup id="fnref:4" role="doc-noteref"><a href="#fn:4" class="footnote" rel="footnote">4</a></sup> of OECD HAN database because <code class="language-plaintext highlighter-rouge">EP3181711</code> was granted by EPO and also
published as <code class="language-plaintext highlighter-rouge">US2017165795</code>. However, only one of them is included in the
database as shown in Table 11.</p>

<p><strong>Using EPO patents.</strong> By using EPO patent numbers, we can avoid the issue of
over count across patent offices with the risk of under count. However,
we have not solved the issue of over count within EPO. Table 12 shows not all patents from <code class="language-plaintext highlighter-rouge">HAN_PATENTS</code> were granted.</p>

<div class="table-caption">
<span class="table-caption-label">Table 12.</span> Selected patents for Airbus defence (DE) from EPO 
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">HAN_ID</th>
      <th style="text-align: center">HARM_ID</th>
      <th style="text-align: center">Appln_id</th>
      <th style="text-align: center">Publn_auth</th>
      <th style="text-align: center">Patent_number</th>
      <th style="text-align: center">Granted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">213</td>
      <td style="text-align: center">EP</td>
      <td style="text-align: center">EP2030891</td>
      <td style="text-align: center">No</td>
    </tr>
    <tr>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">65448</td>
      <td style="text-align: center">EP</td>
      <td style="text-align: center">EP2025928</td>
      <td style="text-align: center">No</td>
    </tr>
    <tr>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">156990</td>
      <td style="text-align: center">EP</td>
      <td style="text-align: center">EP1920908</td>
      <td style="text-align: center">Yes</td>
    </tr>
    <tr>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">161551</td>
      <td style="text-align: center">EP</td>
      <td style="text-align: center">EP1972896</td>
      <td style="text-align: center">Yes</td>
    </tr>
    <tr>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">173385</td>
      <td style="text-align: center">EP</td>
      <td style="text-align: center">EP2134522</td>
      <td style="text-align: center">Yes</td>
    </tr>
    <tr>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">60513</td>
      <td style="text-align: center">173386</td>
      <td style="text-align: center">EP</td>
      <td style="text-align: center">EP2136979</td>
      <td style="text-align: center">Yes</td>
    </tr>
  </tbody>
</table>

<p><strong>Summary.</strong> At this stage, let’s summarize what have done.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Code-Block 5. Summary of analysis until now</span><span class="w">
</span><span class="c1"># read dataset 1, 2, and 3 </span><span class="w">
</span><span class="n">de_firms</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fread</span><span class="p">(</span><span class="s1">'work/notebooks/patent/data/orbis_de_matched_l.csv'</span><span class="p">)</span><span class="w">
</span><span class="n">han_names</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fread</span><span class="p">(</span><span class="s1">'work/notebooks/patent/data/202208_HAN_NAMES.txt'</span><span class="p">)</span><span class="w">
</span><span class="n">han_patents</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fread</span><span class="p">(</span><span class="s1">'work/notebooks/patent/data/202208_HAN_PATENTS.txt'</span><span class="p">)</span><span class="w">

</span><span class="c1"># filter out germany firms from han_names </span><span class="w">
</span><span class="c1"># by setting Person_ctry_code == 'DE'</span><span class="w">
</span><span class="c1"># match names "AIRBUS DEFENCE" and get their HAN_ID</span><span class="w">
</span><span class="n">airbus</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">toupper</span><span class="p">(</span><span class="s1">'Airbus Defence'</span><span class="p">)</span><span class="w">
</span><span class="n">han_names</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">Person_ctry_code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'DE'</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">Clean_name</span><span class="w"> </span><span class="o">%like%</span><span class="w"> </span><span class="n">airbus</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="n">HAN_ID</span><span class="p">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">airbus_han_ids</span><span class="w">

</span><span class="c1"># calcualte the summary statistics for AIRBUS DEFENCE</span><span class="w">
</span><span class="n">han_patents</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">HAN_ID</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">airbus_han_ids</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">.N</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">=</span><span class="n">Publn_auth</span><span class="p">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">foo</span><span class="w">
    </span><span class="n">transform</span><span class="p">(</span><span class="n">adorn_totals</span><span class="p">(</span><span class="n">foo</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">transpose</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">row_to_names</span><span class="p">(</span><span class="n">row_number</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">

</span><span class="c1"># focusing on patents from EPO</span><span class="w">
</span><span class="c1"># filter with condition Publn_auth == 'EP'</span><span class="w">
</span><span class="n">han_patents</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">HAN_ID</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">airbus_han_ids</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">Publn_auth</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'EP'</span><span class="p">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">airbus_ep_patents</span><span class="w">
</span></code></pre></div></div>

<p>With all patent documents of AIRBUS DEFENCE AND SPACE GMBH from EPO we 
ready to figure out how to search for granted patents. The input for 
the next step should be <code class="language-plaintext highlighter-rouge">airbus_ep_patents</code>, which is a table with 
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>716</mn></mrow><annotation encoding="application/x-tex">716</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">7</span><span class="mord">1</span><span class="mord">6</span></span></span></span> rows as shown in Table 12.</p>

<h3 id="search-for-granted-patents">Search for granted patents</h3>

<p>If you have registered PATSTAT online database (free trial for one month) or 
bought the database, you can extract more information from it based on
<code class="language-plaintext highlighter-rouge">Appln_id</code> which is the unique identifier used in PATSTAT. For instance,</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">tls211_pat_publn</span>  <span class="c1">-- tls211_pat_publn is the publication table</span>
<span class="k">WHERE</span> <span class="n">appln_id</span> <span class="o">=</span> <span class="mi">156990</span>  <span class="c1">-- third row from Table 12</span>
</code></pre></div></div>
<p>With the above query, I got the following results.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">pat_publn_id</th>
      <th style="text-align: center">publn_kind</th>
      <th style="text-align: center">appln_id</th>
      <th style="text-align: center">publn_date</th>
      <th style="text-align: center">publn_first_grant</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">277148936</td>
      <td style="text-align: center">A1</td>
      <td style="text-align: center">156990</td>
      <td style="text-align: center">2008-05-14</td>
      <td style="text-align: center">N</td>
    </tr>
    <tr>
      <td style="text-align: center">437725522</td>
      <td style="text-align: center">B1</td>
      <td style="text-align: center">156990</td>
      <td style="text-align: center">2015-04-08</td>
      <td style="text-align: center">Y</td>
    </tr>
  </tbody>
</table>

<p>This tells us whether the patent was granted or not. However, we need to
extract this kind of information with thousands of entries (if not millions).
Right now, I could not find a way from PATSTAT online to do this (please email
to me if you knew how to do it, thanks in advance).</p>

<p>To search for the granted information in a programming environment,
we need an API. Luckily, EPO provides this kind of APIs:</p>

<ul>
  <li>one is  called
<a href="https://www.epo.org/searching-for-patents/data/web-services/ops_de.html" target="_blank">Open Patent Services</a>
    <ul>
      <li>use this when you want to search or query from scratch</li>
      <li>use this when you want to extract information from major patent office</li>
    </ul>
  </li>
  <li>the other one is called <a href="https://www.epo.org/searching-for-patents/data/linked-open-data.html">Linked open EP data</a>
    <ul>
      <li>use this when you already have patent numbers with <code class="language-plaintext highlighter-rouge">EP</code> format</li>
      <li>for non-EP documents (such as <code class="language-plaintext highlighter-rouge">US10703486</code>), coverage is limited to basic patent identification information</li>
      <li>there is no search API endpoint from this open service, but one can search or query with <a href="https://en.wikipedia.org/wiki/SPARQL" target="_blank">SPARQL</a>, we will learn how to do this in this post</li>
    </ul>
  </li>
</ul>

<p>Since we use <strong>only EPO patents</strong> and  have patent numbers and application IDs from OECD HAN database, we will use Linked open EP data.</p>

<h3 id="linked-open-ep-data">Linked open EP data</h3>

<p>According to EPO, “Linked open data offers you new ways of combining
patent data and non-patent data in your work”. Linked open EP data can be queried, retrieved and viewed using standardized web technologies like HTTP,
URI and <a href="https://en.wikipedia.org/wiki/SPARQL" target="_blank">SPARQL</a>.</p>

<p><strong>Back to our case.</strong> As we have stated from the last section, we want to
search for granted patents based on <code class="language-plaintext highlighter-rouge">Patent_number</code>. Those patent numbers we 
have are publication numbers. Therefore, we should use APIs for publications.
Please read the following documents from EPO:</p>

<ul>
  <li><a href="https://data.epo.org/linked-data/documentation/data-coverage.html" target="_blank">Coverage of linked open EP data</a></li>
  <li><a href="https://data.epo.org/linked-data/documentation/api-overview.html" target="_blank">API Overview</a></li>
  <li><a href="https://data.epo.org/linked-data/documentation/api-reference.html" target="_blank">API Reference</a></li>
</ul>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>there are more than 100 million patent documents from leading industrialized and developing countries in EPO’s database. <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p><code class="language-plaintext highlighter-rouge">HAN_PATENTS</code> include both patent application documents (A1 or A2) and granted patents (B1 or B2), therefore we need to figure out how to extract granted patents. <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:3" role="doc-endnote">
      <p>actually this kind of problem is very common in business analytics or any text analysis related to identifying entities’ names. <a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:4" role="doc-endnote">
      <p>it is unavoidable for having bias when you work with millions of documents; as long as it is not systematic it should be okay. <a href="#fnref:4" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

    </div>
    <div id='bibliography'>
        <div class='wrap'>
            <ol class="bibliography"><li><span id="de2014introduction">De Rassenfosse, G., Dernis, H., &amp; Boedt, G. (2014). An introduction to the Patstat database with example queries. <i>Australian Economic Review</i>, <i>47</i>(3), 395–408.</span></li>
<li><span id="kang2016patstat">Kang, B., &amp; Tarasconi, G. (2016). PATSTAT revisited: Suggestions for better usage. <i>World Patent Information</i>, <i>46</i>, 56–63.</span></li>
<li><span id="webb2005analysing">Webb, C., Dernis, H., Harhoff, D., &amp; Hoisl, K. (2005). <i>Analysing European and international patent citations: A set of EPO patent database building blocks</i>.</span></li></ol>
        </div>
    </div>
</div>
<!-- back-to-top button from Mkdocs material -->
<a
href="#"
id="back-top"
aria-label="Back-to-top link"
style="
position: fixed;
bottom: 10%;
margin-left:85%;
color: #808080;
background-color: #FFFFFF;"
hidden
>
<img width="30px" height="30px" alt="up-arrow" src="/images/up-arrow.png">
</a>

<script src="/assets/js/codeCopy.js"></script>
<script src="/assets/js/backTotop.js"></script>
<script>
    var lis = document.getElementsByClassName("footnotes")
    for (let i = 0; i < lis.length; i++){
        var li_tag = lis[i].getElementsByTagName('li')
    
        for (let j = 0; j < li_tag.length; j++) {
            li_tag[j].setAttribute('role', 'link')
        }
        var a_tag = lis[i].getElementsByTagName('a')
    
        for (let k = 0; k < a_tag.length; k++) {
            a_tag[k].setAttribute('role', 'link')
        }
    }
    </script>
</body>
</html>