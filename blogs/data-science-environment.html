<!DOCTYPE html>
<html lang="en">
<head>
    <html lang="en">
  <head>
    <title>
      Programming Environment for Data Science
    </title>
    <meta charset='UTF-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name='author' content='Michael Wang Fei'>
    <meta name='keywords' content='
          machine learning,
          statistical machine learning,
          bayesian inference,
          statistics,
          computational statistics,
          linear algebra,
          numerical linear algebra,
          statistical software,
          deep learning,
          computer science,
          probability,
          math,
          mathematics,
          probabilistic reasoning
      '>
      <meta name='keywords' content='data science, Python, R, packages, dependencies, Docker, container, ssh, remote'>
      <link rel="stylesheet" href="/css/blog.css">
      <link rel="stylesheet" href="/css/markdown.css">
      <link rel="stylesheet" href="/css/trac.css">
      <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
      <!-- The loading of KaTeX is deferred to speed up page rendering -->
      <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
      <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
      <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Programming Environment for Data Science</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Programming Environment for Data Science" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Every time you start a new project or analyze a new dataset, you might come to a situation that you need to install a new package. However, sometimes installing a package could take you a full day (I believe every programmer has this kind of experience). To do data analysis with open source ecosystem, we rely on so many packages. If anything in this long chain of dependence goes wrong, we have to halt our project." />
<meta property="og:description" content="Every time you start a new project or analyze a new dataset, you might come to a situation that you need to install a new package. However, sometimes installing a package could take you a full day (I believe every programmer has this kind of experience). To do data analysis with open source ecosystem, we rely on so many packages. If anything in this long chain of dependence goes wrong, we have to halt our project." />
<link rel="canonical" href="https://oceanumeric.github.io//blogs/data-science-environment" />
<meta property="og:url" content="https://oceanumeric.github.io//blogs/data-science-environment" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-01-07T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Programming Environment for Data Science" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-07T00:00:00+00:00","datePublished":"2023-01-07T00:00:00+00:00","description":"Every time you start a new project or analyze a new dataset, you might come to a situation that you need to install a new package. However, sometimes installing a package could take you a full day (I believe every programmer has this kind of experience). To do data analysis with open source ecosystem, we rely on so many packages. If anything in this long chain of dependence goes wrong, we have to halt our project.","headline":"Programming Environment for Data Science","mainEntityOfPage":{"@type":"WebPage","@id":"https://oceanumeric.github.io//blogs/data-science-environment"},"url":"https://oceanumeric.github.io//blogs/data-science-environment"}</script>
<!-- End Jekyll SEO tag -->

  </head>
</html>


</head>
<body>
<div class='content'>
    <!DOCTYPE html>
<div class='nav'>
    <ul class='wrap'>
        <li><a href='/'>Home</a></li>
        <li><a href='/blog'>Blog</a></li>
        <li><a href='/math'>Math</a></li>
        <li><a href='/tags'>Tags</a></li>
    </ul>
</div>
</html>

    <div class='front-matter'>
        <div class='wrap'>
            <h1>Programming Environment for Data Science</h1>
            <h4>What should we do when we realize some packages from Python or R could not be installed in our local machine?</h4>
            <div class='bylines'>
                <div class='byline'>
                    
                    
                        <span class="post-tags">
                            <i class="fa fa-tags"></i>
                            
                            <a href="/blog-tags/r">r</a>, 
                            
                            <a href="/blog-tags/python">python</a>, 
                            
                            <a href="/blog-tags/data-science">data-science</a>, 
                            
                            <a href="/blog-tags/docker">docker</a>
                            
                        </span>
                    
                    <h3>Published</h3>
                    <p>07 January 2023</p>
                </div>
            </div>
            <div class='clear'></div>
        </div>
    </div>
    <div class='wrap article'>
        <p>Every time you start a new project or analyze a new dataset, you might come
to a situation that you need to <code class="language-plaintext highlighter-rouge">install</code> a new package. However, sometimes
installing a package could take you a full day (I believe every programmer
has this kind of experience). To do data analysis with open source ecosystem,
we rely on so many packages. If anything in this long chain of dependence
goes wrong, we have to halt our project.</p>

<ul>
  <li><a href="#an-unpleasant-experience">An unpleasant experience</a></li>
  <li><a href="#the-ideal-environment">The ideal environment</a></li>
  <li><a href="#build-a-docker-image">Build a docker image</a></li>
  <li><a href="#using-datascience-notebook-image">Using datascience-notebook image</a></li>
  <li><a href="#using-datascience-notebook-image-as-a-server">Using datascience-notebook image as a server</a></li>
</ul>

<h2 id="an-unpleasant-experience">An unpleasant experience</h2>

<p>Personally, I have to set up different kinds of programming environment
for different projects. For example, you might need a programming environment
with GPUs, you might need a programming environment that allows you to do
data analysis with <code class="language-plaintext highlighter-rouge">Python</code>, <code class="language-plaintext highlighter-rouge">R</code> and <code class="language-plaintext highlighter-rouge">Stata</code> at the same time.</p>

<p>How could we make sure our operating system will not be messed up each time
when we install and uninstall different softwares. For instance, my current
project needs me to use <code class="language-plaintext highlighter-rouge">Python</code> and <code class="language-plaintext highlighter-rouge">R</code> together, and it annoyed me when
I failed to install a package in <code class="language-plaintext highlighter-rouge">R</code> called <code class="language-plaintext highlighter-rouge">devtools</code>. It turned out three
packages that <code class="language-plaintext highlighter-rouge">devtools</code> depends on could not be installed:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Warning</span><span class="w"> </span><span class="n">messages</span><span class="o">:</span><span class="w">
</span><span class="m">1</span><span class="o">:</span><span class="w"> </span><span class="n">In</span><span class="w"> </span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"devtools"</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w">
  </span><span class="n">installation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="s1">'ragg'</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">zero</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">status</span><span class="w">
</span><span class="m">2</span><span class="o">:</span><span class="w"> </span><span class="n">In</span><span class="w"> </span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"devtools"</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w">
  </span><span class="n">installation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="s1">'pkgdown'</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">zero</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">status</span><span class="w">
</span><span class="m">3</span><span class="o">:</span><span class="w"> </span><span class="n">In</span><span class="w"> </span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"devtools"</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w">
  </span><span class="n">installation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="s1">'devtools'</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">zero</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">status</span><span class="w">
</span></code></pre></div></div>

<p>I tried to fix this by google and still failed to install them after TWO hours.
Then, I decided to use <a href="https://www.docker.com/" target="_blank">Docker</a>. 
Docker takes away repetitive, mundane configuration tasks and is used throughout 
the development lifecycle for fast, easy and portable application 
development – desktop and cloud.</p>

<p>If you knew <code class="language-plaintext highlighter-rouge">virtual envrionment</code> in <code class="language-plaintext highlighter-rouge">Python</code>, then Docker is the tool for
the operating system. With docker, you can have Linux image in your Windows
or MacOS system. Every time you run an image, you are creating a container
that could be:</p>

<ul>
  <li>isolated operating system for a certain task</li>
  <li>managed and updated in terms of software and packages dependences</li>
  <li>used locally or remotely as a server</li>
</ul>

<h2 id="the-ideal-environment">The ideal environment</h2>

<p>The idea working environment for data scientists should be of accessible,
reusable, having no trouble of installing most of packages, and could
be updated for new projects. To have this idea working environment, we could
buy a laptop or server and install everything we need and do not install
other softwares that are not needed for data analysis.</p>

<p>However, I do not have money for this. Even I had money to buy all those
hardwares, it is time consuming to switch between them. Therefore, we need
Docker.</p>

<h2 id="build-a-docker-image">Build a docker image</h2>

<p>With Docker installed, we can create a <code class="language-plaintext highlighter-rouge">Dockerfile</code> to create an image.
For instance, the following one is taken from <a href="https://github.com/jupyter/docker-stacks/blob/main/docker-stacks-foundation/Dockerfile" target="_blank">Jupyter development team</a>. I think knowing 
how to build a docker image is quite essential for being a data scientist or data
engineer. We will walk through the following Dockerfile and explain what 
it does.</p>

<div class="language-docker highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># This is just an example, do not run it! </span>
<span class="c"># Copyright (c) Jupyter Development Team.</span>
<span class="c"># Distributed under the terms of the Modified BSD License.</span>

<span class="c">################ Setup a base operating system ###########</span>
<span class="c"># Ubuntu 22.04 (jammy)</span>
<span class="c"># https://hub.docker.com/_/ubuntu/tags?page=1&amp;name=jammy</span>
<span class="c"># choose ubuntu:22.04 as base operating system </span>
<span class="k">ARG</span><span class="s"> ROOT_CONTAINER=ubuntu:22.04</span>

<span class="k">FROM</span><span class="s"> $ROOT_CONTAINER</span>

<span class="c"># add docker user information</span>
<span class="c"># ARG - define arguments build-time variables. </span>
<span class="c"># you can set up user id otherwise everytime you run docker you will have</span>
<span class="c"># different ids, such as root@71b22c5215f2; root@79a18ea42f06; </span>
<span class="k">LABEL</span><span class="s"> maintainer="Jupyter Project &lt;jupyter@googlegroups.com&gt;"</span>

<span class="c"># you will see this user when you run docker container </span>
<span class="k">ARG</span><span class="s"> NB_USER="jovyan"</span>
<span class="k">ARG</span><span class="s"> NB_UID="1000"</span>
<span class="k">ARG</span><span class="s"> NB_GID="100"</span>

<span class="c"># running shell </span>
<span class="c"># This setting prevents errors in a pipeline from being masked.</span>
<span class="c"># image you apt-get install, but error was not returned </span>
<span class="k">SHELL</span><span class="s"> ["/bin/bash", "-o", "pipefail", "-c"]</span>

<span class="c"># set up the user for Ubuntu</span>
<span class="c"># meaning we will install all softwares in our Ubuntu image as root user </span>
<span class="k">USER</span><span class="s"> root</span>

<span class="c"># envrironment variable for installation </span>
<span class="c"># we do not need to interact during installing process such as answering [y/n]</span>
<span class="k">ENV</span><span class="s"> DEBIAN_FRONTEND noninteractive</span>

<span class="c">################### Install Softwares in Ubutun #########################</span>
<span class="c"># if you have ever used Ubuntun</span>
<span class="k">RUN </span>apt-get update <span class="nt">--yes</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span>    <span class="c"># - apt-get upgrade is run to patch known vulnerabilities in apt-get packages as</span>
    <span class="c">#   the ubuntu base image is rebuilt too seldom sometimes (less than once a month)</span>
    apt-get upgrade --yes &amp;&amp; \
    apt-get install --yes --no-install-recommends \
    # - bzip2 is necessary to extract the micromamba executable.
    bzip2 \
    p7zip-full \
    ca-certificates \
    locales \
    sudo \
    # - tini is installed as a helpful container entrypoint that reaps zombie
    <span class="c">#   processes and such of the actual executable we want to start, see</span>
    <span class="c">#   https://github.com/krallin/tini#why-tini for details.</span>
    tini \
    wget &amp;&amp; \
    apt-get clean &amp;&amp; rm -rf /var/lib/apt/lists/* &amp;&amp; \
    echo "en_US.UTF-8 UTF-8" &gt; /etc/locale.gen &amp;&amp; \
    locale-gen


<span class="c"># Configure environment</span>
<span class="k">ENV</span><span class="s"> CONDA_DIR=/opt/conda \</span>
    SHELL=/bin/bash \
    NB_USER="${NB_USER}" \
    NB_UID=${NB_UID} \
    NB_GID=${NB_GID} \
    LC_ALL=en_US.UTF-8 \
    LANG=en_US.UTF-8 \
    LANGUAGE=en_US.UTF-8
<span class="k">ENV</span><span class="s"> PATH="${CONDA_DIR}/bin:${PATH}" \</span>
    HOME="/home/${NB_USER}"

# Copy a script that we will use to correct permissions after running certain commands
<span class="k">COPY</span><span class="s"> fix-permissions /usr/local/bin/fix-permissions</span>
<span class="k">RUN </span><span class="nb">chmod </span>a+rx /usr/local/bin/fix-permissions

<span class="c"># Enable prompt color in the skeleton .bashrc before creating the default NB_USER</span>
<span class="c"># hadolint ignore=SC2016</span>
<span class="c"># .........</span>
<span class="c"># .........</span>
<span class="c"># more comannd</span>
</code></pre></div></div>

<p>The original <code class="language-plaintext highlighter-rouge">Dockerfile</code> is very long, we will not discuss everything here.
Once the operating system and dependencies become complex, we could reply
on images built by others. Jupyter development team has built several 
images, such as <a href="https://hub.docker.com/r/jupyter/datascience-notebook" target="_blank">datascience-notebook</a>,
<a href="https://hub.docker.com/r/jupyter/tensorflow-notebook" target="_blank">tensorflow-notebook</a>, 
and <a href="https://hub.docker.com/r/jupyter/r-notebook" target="_blank">r-notebook</a>. 
With those images, you can customize or build new images based on them.</p>

<h2 id="using-datascience-notebook-image">Using datascience-notebook image</h2>

<ul>
  <li><a href="#using-it-without-accessing-local-files-an-isolated-container">without accessing local files</a></li>
  <li><a href="#using-it-with-accessing-files-locally">with accessing local files</a></li>
  <li><a href="#start-the-jupyter-directly">start jupyter from container directly</a></li>
</ul>

<p>Since <code class="language-plaintext highlighter-rouge">datascience-notebook</code> image has been downloaded (pulled) 10M+, I will
just use this image instead of building my own programming environment. When 
you are using this image, you have two ways to run it:</p>

<ul>
  <li>use it as an isolated container and save all files within this container</li>
  <li>use it as a computation station and save and access files locally</li>
</ul>

<p>Before we run everything, make sure you pulled the image by running
<code class="language-plaintext highlighter-rouge">docker pull jupyter/datascience-notebook</code>.</p>

<h4 id="using-it-without-accessing-local-files-an-isolated-container">Using it without accessing local files (an isolated container)</h4>

<p>You could skip this section as most users need to access the local files
from their own computer (or whatever working station) and interact with
the container. The following command will not allow you read a local file
and analyze your data. You have to download everything within it
after running the container (see you clone a git repository within it
and work on it).</p>

<p>For the scenario one, we could run</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -it means iteractive with terminal</span>
<span class="c"># --rm means removing container after exit</span>
<span class="c"># start.sh set up the starting point</span>
<span class="c"># default one is jupyter lab </span>
docker run <span class="nt">-it</span> <span class="nt">--rm</span> jupyter/datascience-notebook start.sh bash
</code></pre></div></div>

<p>Once you run it, you should get</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Entered start.sh with args: bash
Executing the command: bash
(base) jovyan@72e83ed33c2f:~$ 
</code></pre></div></div>

<p>With the username ‘jovyang’ (username set in the Dockerfile) and id as
<code class="language-plaintext highlighter-rouge">72e83ed33c2f</code> and dollar sign $, now you are having a <code class="language-plaintext highlighter-rouge">Ubuntu</code> system
with all essential packages installed.</p>

<p>As the following code shows, there are no extra files in our container.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span>base<span class="o">)</span> jovyan@72e83ed33c2f:~<span class="nv">$ </span><span class="nb">ls
</span>work
<span class="o">(</span>base<span class="o">)</span> jovyan@72e83ed33c2f:~<span class="nv">$ </span><span class="nb">cd </span>work
<span class="o">(</span>base<span class="o">)</span> jovyan@72e83ed33c2f:~/work<span class="nv">$ </span><span class="nb">ls</span>
<span class="o">(</span>base<span class="o">)</span> jovyan@72e83ed33c2f:~/work<span class="nv">$ </span>
</code></pre></div></div>

<p>Sometime you need to open multiple terminal windows, you can do this:</p>

<ul>
  <li>step 1: run a container</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># the start.sh bash is option only for jupyter/datascience-notebook image</span>
docker run <span class="nt">-it</span> <span class="nt">--rm</span> <span class="nt">--name</span> notebook2 jupyter/datascience-notebook start.sh bash
</code></pre></div></div>

<ul>
  <li>step 2: open another terminal and check the running containers</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># list current containers </span>
docker ps
<span class="c"># to stop a contaier</span>
docker stop &lt;container-name&gt;
</code></pre></div></div>

<p>It will show I have a container called <code class="language-plaintext highlighter-rouge">notebook2</code> running and could be interacted.
Then run the following command gives us another terminal:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker <span class="nb">exec</span> <span class="nt">-it</span> notebook2 /bin/bash
<span class="o">(</span>base<span class="o">)</span> jovyan@20a1058c5415:~<span class="nv">$ </span>
<span class="c"># turn it off</span>
<span class="nb">exit</span> 
</code></pre></div></div>
<p>Notice the user ID is the same one as we are interacting with the same container.</p>

<p>If you want to run <code class="language-plaintext highlighter-rouge">Jupyter Notebook</code> within this container, we need to 
run the container with forwarding the tcp/ip port.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="se">\</span>
        <span class="nt">-it</span> <span class="nt">--rm</span> <span class="se">\</span>
        <span class="nt">-p</span> 9999:9999 <span class="se">\</span>
        <span class="nt">--name</span> notebook2 <span class="se">\</span>
        jupyter/datascience-notebook start.sh bash
Entered start.sh with args: bash
Executing the <span class="nb">command</span>: bash
<span class="o">(</span>base<span class="o">)</span> jovyan@3fe799dcc78f:~<span class="nv">$ </span>jupyter notebook <span class="nt">--port</span> 9999 

<span class="c"># you may run</span>
jupyter notebook <span class="nt">--ip</span> 0.0.0.0 <span class="nt">--port</span> 9999 <span class="nt">--no-browser</span> <span class="nt">--allow-root</span>
</code></pre></div></div>

<ul>
  <li>Note: the backslash allows us to put a command over multiple lines for 
readability. On Windows powershell you should replace this with backticks.</li>
  <li><code class="language-plaintext highlighter-rouge">--rm</code> remove the container when finished.</li>
  <li><code class="language-plaintext highlighter-rouge">-p 9999:9999</code> linking port 9999 of the host system (your local machine) to port 9999 of the container.</li>
  <li>jupyter/datascience-notebook: the name of the image</li>
  <li><code class="language-plaintext highlighter-rouge">start.sh bash</code> is option for the image to start it with bash (default is jupyter-lab)</li>
  <li>for jupyter, <code class="language-plaintext highlighter-rouge">--ip</code> is to set up the ip address, <code class="language-plaintext highlighter-rouge">--port</code> for port number, <code class="language-plaintext highlighter-rouge">--allow-root</code> allows 
user to access the root filers.</li>
</ul>

<h4 id="using-it-with-accessing-files-locally">Using it with accessing files locally</h4>

<p>Most time, we want to use this container as a computation station and
save and access local files with no restriction. Then we need to run</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># you can call whatever youu want --name &lt;your name&gt;</span>
<span class="c"># -v meaning we now links current folder (${PWD}) with jovyan/work</span>
docker run <span class="nt">-it</span> <span class="nt">--rm</span> <span class="nt">--name</span> notebook2 <span class="nt">-v</span> <span class="s2">"</span><span class="k">${</span><span class="nv">PWD</span><span class="k">}</span><span class="s2">"</span>:/home/jovyan/work jupyter/datascience-notebook start.sh bash

Entered start.sh with args: bash
Executing the <span class="nb">command</span>: bash
<span class="o">(</span>base<span class="o">)</span> jovyan@2623ed260b84:~<span class="nv">$ </span><span class="nb">ls
</span>work
<span class="o">(</span>base<span class="o">)</span> jovyan@2623ed260b84:~<span class="nv">$ </span><span class="nb">cd </span>work
<span class="o">(</span>base<span class="o">)</span> jovyan@2623ed260b84:~/work<span class="nv">$ </span><span class="nb">ls
</span>blogenv  Dockerfile  docs  LICENSE  notebooks  README.md
<span class="o">(</span>base<span class="o">)</span> jovyan@2623ed260b84:~/work<span class="nv">$ </span>
</code></pre></div></div>
<p>You can see my local files are shown within the container. If you are using
<code class="language-plaintext highlighter-rouge">ssh</code> or doing remote development with <code class="language-plaintext highlighter-rouge">VS Code</code>, you should link the port
whenever you want to run jupyter notebook.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run \
        -it --rm \
        -p 7171:7171 \ 
        --name notebook2 \
        -v "${PWD}":/home/jovyan/work \
        jupyter/datascience-notebook start.sh bash
Entered start.sh with args: bash
Executing the command: bash
(base) jovyan@3fe799dcc78f:~$ jupyter notebook --port 7171 --no-browser
</code></pre></div></div>

<h4 id="start-the-jupyter-directly">Start the jupyter directly</h4>

<p>Most of time, you just need to start the jupyter lab or notebook directly.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="se">\</span>
	<span class="nt">--rm</span> <span class="nt">-p</span> 5657:5657 <span class="se">\</span>
    <span class="nt">-e</span> <span class="nv">JUPYTER_TOKEN</span><span class="o">=</span>haha <span class="se">\</span>
    <span class="nt">-e</span> <span class="nv">JUPYTER_PORT</span><span class="o">=</span>5657 <span class="se">\</span>
    <span class="nt">--name</span> notebook2 <span class="se">\</span>
	jupyter/datascience-notebook 
</code></pre></div></div>

<p>The above command does not allow users to access the local files. Instead, 
we need to run:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="se">\</span>
	<span class="nt">--rm</span> <span class="nt">-p</span> 5657:5657 <span class="se">\</span>
    <span class="nt">-e</span> <span class="nv">JUPYTER_TOKEN</span><span class="o">=</span>haha <span class="se">\</span>
    <span class="nt">-e</span> <span class="nv">JUPYTER_PORT</span><span class="o">=</span>5657 <span class="se">\</span>
    <span class="nt">--name</span> notebook2 <span class="se">\</span>
    <span class="nt">-v</span> <span class="s2">"</span><span class="k">${</span><span class="nv">PWD</span><span class="k">}</span><span class="s2">"</span>:/home/jovyan/work <span class="se">\</span>
	jupyter/datascience-notebook
</code></pre></div></div>

<p>For more configurations, please read <a href="https://jupyter-docker-stacks.readthedocs.io/en/latest/using/common.html?highlight=JUPYTER_PORT#additional-runtime-configurations" target="_blank">Jupyter Docker Stacks Documentation</a>.</p>

<h2 id="using-datascience-notebook-image-as-a-server">Using datascience-notebook image as a server</h2>

<p>To automate what we did, we could use <code class="language-plaintext highlighter-rouge">jupyter/datascience-notebook</code> image
as a server keep running and we could use it anytime and anywhere we want.
With <a href="https://marketplace.visualstudio.com/items?itemName=ms-toolsai.jupyter" target="_blank">jupyter extension</a> 
and <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-ssh" target="_blank">Remote-SHH extension</a> of
VS Code, I managed to build a server:</p>

<ul>
  <li>step 1: create a jupyter server</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># you can change the port, but make sure three ports are the same one</span>
docker run <span class="nt">-d</span> <span class="se">\</span>
    <span class="nt">--rm</span> <span class="nt">-p</span> 5657:5657 <span class="se">\</span>
    <span class="nt">-e</span> <span class="nv">JUPYTER_TOKEN</span><span class="o">=</span>your_own_token <span class="se">\</span>
    <span class="nt">-e</span> <span class="nv">JUPYTER_PORT</span><span class="o">=</span>5657 <span class="se">\</span>
    <span class="nt">--name</span> notebook2 <span class="se">\</span>
    <span class="nt">-v</span> <span class="s2">"</span><span class="k">${</span><span class="nv">PWD</span><span class="k">}</span><span class="s2">"</span>:/home/jovyan/work <span class="se">\</span>
	jupyter/datascience-notebook
</code></pre></div></div>

<p>We now run our docker in the background (with <code class="language-plaintext highlighter-rouge">-d</code> detached option).</p>

<p>Now copy the link first(should be localhost:5657 or your-ip-address:5657). Then wShortcut CTRL + SHIFT + P (Windows) or Command + SHIFT + P (macOS), type <code class="language-plaintext highlighter-rouge">specify</code>, you should see the following window popped up.</p>

<div class="figure">
    <img src="/images/blog/jupyter-server.png" alt="Screenshot of VS Code" style="width: 80%; display: block; margin: 0 auto;" />
    <div class="caption">
        <span class="caption-label">Figure 1.</span>
        Screenshot of VS Code
    </div>
</div>

<p>Enter the link and token by following instructions, you have a data-science
server with all essential packages now.</p>

<p>Here is my server:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CONTAINER ID   IMAGE                          CREATED       STATUS                 PORTS                   
db7537048e58   jupyter/datascience-notebook   4 hours ago   Up 4 hours <span class="o">(</span>healthy<span class="o">)</span>   0.0.0.0:8888-&gt;8888/tcp
</code></pre></div></div>

<p>If you want to want to install new packages while your sever is running, you
could run</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># check your container name name docker ps</span>
<span class="c"># mine is called notebook</span>
<span class="c"># docker exec -it notebook /bin/bash</span>
docker <span class="nb">exec</span> <span class="nt">-it</span> &lt;container-name&gt; /bin/bash
</code></pre></div></div>

<p>ENJOY! :)</p>


    </div>
    <div id='bibliography'>
        <div class='wrap'>
            <ol class="bibliography"></ol>
        </div>
    </div>
</div>
<!-- back-to-top button from Mkdocs material -->
<a
href="#"
id="back-top"
data-md-component="top"
style="
position: fixed;
bottom: 10%;
margin-left:85%;
color: #808080;
background-color: #FFFFFF;"
hidden
>
<img width="30px" src="/images/up-arrow.png">
</a>

<script src="/assets/js/codeCopy.js"></script>
<script src="/assets/js/backTotop.js"></script>
<script>
    var lis = document.getElementsByClassName("footnotes")
    for (let i = 0; i < lis.length; i++){
        var li_tag = lis[i].getElementsByTagName('li')
    
        for (let j = 0; j < li_tag.length; j++) {
            li_tag[j].setAttribute('role', 'link')
        }
        var a_tag = lis[i].getElementsByTagName('a')
    
        for (let k = 0; k < a_tag.length; k++) {
            a_tag[k].setAttribute('role', 'link')
        }
    }
    </script>
</body>
</html>