<!DOCTYPE html>
<html lang="en">
<head>
    <html lang="en">
  <head>
    <title>
      Making Animations for Mathematics
    </title>
    <meta charset='UTF-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name='author' content='Michael Wang Fei'>
    <meta name='keywords' content='
          machine learning,
          statistical machine learning,
          bayesian inference,
          statistics,
          computational statistics,
          linear algebra,
          numerical linear algebra,
          statistical software,
          deep learning,
          computer science,
          probability,
          math,
          mathematics,
          probabilistic reasoning
      '>
      <meta name='keywords' content='math Manim animation python videos'>
      <link rel="stylesheet" href="/css/main.css">
      <link rel="stylesheet" href="/css/blog.css">
      <link rel="stylesheet" href="/css/markdown.css">
      <link rel="stylesheet" href="/css/trac.css">
      <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
      <!-- The loading of KaTeX is deferred to speed up page rendering -->
      <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
      <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
      <link href="https://fonts.cdnfonts.com/css/lucida-sans" rel="stylesheet">
                
      <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Making Animations for Mathematics</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Making Animations for Mathematics" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Suppose you want to create some animations like the following one by learning an animation engine called Manim. However, the official document is difficult to follow. What should you do?" />
<meta property="og:description" content="Suppose you want to create some animations like the following one by learning an animation engine called Manim. However, the official document is difficult to follow. What should you do?" />
<link rel="canonical" href="https://oceanumeric.github.io//blogs/math-animation" />
<meta property="og:url" content="https://oceanumeric.github.io//blogs/math-animation" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-11-03T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Making Animations for Mathematics" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-11-03T00:00:00+00:00","datePublished":"2022-11-03T00:00:00+00:00","description":"Suppose you want to create some animations like the following one by learning an animation engine called Manim. However, the official document is difficult to follow. What should you do?","headline":"Making Animations for Mathematics","mainEntityOfPage":{"@type":"WebPage","@id":"https://oceanumeric.github.io//blogs/math-animation"},"url":"https://oceanumeric.github.io//blogs/math-animation"}</script>
<!-- End Jekyll SEO tag -->

  </head>
</html>


</head>
<body>
<div class='content'>
    <!DOCTYPE html>
<div class='nav'>
    <ul class='wrap'>
        <li><a href='/'>Home</a></li>
        <li><a href='/blog'>Blog</a></li>
        <li><a href='/math'>Math</a></li>
        <li><a href='/tags'>Tags</a></li>
    </ul>
</div>
</html>

    <div class='front-matter'>
        <div class='wrap'>
            <h1>Making Animations for Mathematics</h1>
            <h4>Based on the framework of 3brown1blue, I tried to make some animation for mathematics.</h4>
            <div class='bylines'>
                <div class='byline'>
                    
                    
                        <span class="post-tags">
                            <i class="fa fa-tags"></i>
                            
                            <a href="/blog-tags/python">python</a>, 
                            
                            <a href="/blog-tags/math-animation">math-animation</a>
                            
                        </span>
                    
                    <h3>Published</h3>
                    <p>03 November 2022</p>
                </div>
            </div>
            <div class='clear'></div>
        </div>
    </div>
    <div class='wrap article'>
        <p>Suppose you want to create some animations like the following one by learning
an animation engine called <a href="https://github.com/ManimCommunity/manim" target="_blank">Manim</a>.
However, the official document is difficult to follow. What should you do?</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/aircAruvnKk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<p>In this series of posts, I will explain how to make animations step by step 
with <code class="language-plaintext highlighter-rouge">Manim</code>. To start it, let’s install essential packages first. Please 
follow this <a href="https://docs.manim.community/en/stable/installation.html" target="_blank">Link</a>
and install all packages.</p>

<h2 id="big-picture">Big picture</h2>

<p>A movie is made by different <code class="language-plaintext highlighter-rouge">scenes</code> and a scene is made by different kinds 
of <code class="language-plaintext highlighter-rouge">Mobject</code>s(moving objects). To create a scene we need to <code class="language-plaintext highlighter-rouge">create</code> or <code class="language-plaintext highlighter-rouge">add</code>
<code class="language-plaintext highlighter-rouge">Mobject</code>.</p>

<p>Everything starts with the following <code class="language-plaintext highlighter-rouge">class</code>:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">MovieName</span><span class="p">(</span><span class="n">Scene</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># here you create your animation world
</span></code></pre></div></div>

<p>You could take <code class="language-plaintext highlighter-rouge">Scene</code> as your <strong>camera</strong> or your background video which is waiting
for you to act. But who is the <strong>actor</strong>? In our engine, the actor is called
<code class="language-plaintext highlighter-rouge">Mobject</code> which is the most important element (we call it <code class="language-plaintext highlighter-rouge">base class</code>). 
The following figure gives the big picture.</p>

<div class="figure">
    <img src="/images/blog/manim.png" alt="A big picture" style="width: 80%; display: block; margin: 0 auto;" />
    <div class="caption">
        <span class="caption-label">Figure 1.</span> Big Picture of Manim
    </div>
</div>

<p>Every time when you want to create a movie, you need to do the following
three steps:</p>

<ol>
  <li>set up the <code class="language-plaintext highlighter-rouge">Scene</code></li>
  <li>create the <code class="language-plaintext highlighter-rouge">Mobject</code></li>
  <li>call animation <code class="language-plaintext highlighter-rouge">method</code> to make <code class="language-plaintext highlighter-rouge">Mobject</code> to move</li>
</ol>

<p>Sometimes, you might need to zoom in or zoom out with your <code class="language-plaintext highlighter-rouge">camera</code>, which
we will cover those advanced topics in detail later.</p>

<h2 id="set-up-the-scene">Set up the <code class="language-plaintext highlighter-rouge">Scene</code></h2>

<p>To set up the scene, you just need to import the <code class="language-plaintext highlighter-rouge">manim</code> package and create
an inherited class from <code class="language-plaintext highlighter-rouge">Scene</code>.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">manim</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c1"># import 
</span>

<span class="k">class</span> <span class="nc">YourVideoName</span><span class="p">(</span><span class="n">Scene</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># your code starts here 
</span></code></pre></div></div>

<h2 id="create-the-mobject">Create the <code class="language-plaintext highlighter-rouge">Mobject</code></h2>

<p>A <em>moving object</em> is a base class that could engine your animation. For instance,
a simple animation is to make a photo fly in from the left to the right. Then,
a photo is a <em>moving object</em>. In <code class="language-plaintext highlighter-rouge">manim</code>, <code class="language-plaintext highlighter-rouge">ImageMobject</code> could read an image
and make it as a moving object.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">img</span> <span class="o">=</span> <span class="n">ImageMobject</span><span class="p">(</span><span class="s">"images/cuteguy1.png"</span><span class="p">)</span>
<span class="n">img</span><span class="p">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">img</span><span class="p">.</span><span class="n">shift</span><span class="p">(</span><span class="n">LEFT</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<span class="bp">self</span><span class="p">.</span><span class="n">play</span><span class="p">(</span><span class="n">img</span><span class="p">.</span><span class="n">animate</span><span class="p">.</span><span class="n">shift</span><span class="p">(</span><span class="n">RIGHT</span><span class="o">*</span><span class="mi">5</span><span class="p">),</span> <span class="n">run_time</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<p>There are many <em>moving objects</em> in <code class="language-plaintext highlighter-rouge">manim</code>, here is the link:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">frame</code>: Special rectangles.</li>
  <li><code class="language-plaintext highlighter-rouge">geometry</code> - Various geometric Mobjects.</li>
  <li><code class="language-plaintext highlighter-rouge">graph</code> - Mobjects used to represent mathematical graphs (think graph theory, not plotting).</li>
  <li><code class="language-plaintext highlighter-rouge">graphing</code> - Coordinate systems and function graphing related mobjects.</li>
  <li><code class="language-plaintext highlighter-rouge">logo</code> - either the logo from the package or created by yourself (Utilities for Manim’s logo and banner).</li>
  <li><code class="language-plaintext highlighter-rouge">matrix</code> - Mobjects representing matrices.</li>
  <li><code class="language-plaintext highlighter-rouge">mobject</code> -  Base classes for objects that can be displayed.</li>
  <li><code class="language-plaintext highlighter-rouge">svg</code> - Mobjects related to SVG images.</li>
  <li><code class="language-plaintext highlighter-rouge">table</code> -  Mobjects representing tables.</li>
  <li><code class="language-plaintext highlighter-rouge">text</code> - Mobjects used to display Text using Pango or LaTeX.</li>
  <li><code class="language-plaintext highlighter-rouge">three_d</code> - Three-dimensional mobjects.</li>
  <li><code class="language-plaintext highlighter-rouge">types</code> - Specialized mobject base classes.</li>
  <li><code class="language-plaintext highlighter-rouge">value_tracker</code> - Simple mobjects that can be used for storing (and updating) a value.</li>
  <li><code class="language-plaintext highlighter-rouge">vector_field</code> - Mobjects representing vector fields.</li>
</ul>

<h2 id="call-animation-method">Call animation <code class="language-plaintext highlighter-rouge">method</code></h2>

<p>Once you created the <code class="language-plaintext highlighter-rouge">Mobject</code>, then you can call <code class="language-plaintext highlighter-rouge">animation</code> methods to make
them animated. For instance, we have already showed a simple way to animate 
an <code class="language-plaintext highlighter-rouge">Mojbect</code>:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="bp">self</span><span class="p">.</span><span class="n">play</span><span class="p">(</span><span class="n">img</span><span class="p">.</span><span class="n">animate</span><span class="p">.</span><span class="n">shift</span><span class="p">(</span><span class="n">RIGHT</span><span class="o">*</span><span class="mi">5</span><span class="p">),</span> <span class="n">run_time</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<p>Here are the full list of <code class="language-plaintext highlighter-rouge">animation</code> methods:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">animation</code>: Animate mobjects.</li>
  <li><code class="language-plaintext highlighter-rouge">changing</code>: Animation of a mobject boundary and tracing of points.</li>
  <li><code class="language-plaintext highlighter-rouge">composition</code>: Tools for displaying multiple animations at once.</li>
  <li><code class="language-plaintext highlighter-rouge">creation</code>: Animate the display or removal of a mobject from a scene.</li>
  <li><code class="language-plaintext highlighter-rouge">fading</code>: Fading in and out of view.</li>
  <li><code class="language-plaintext highlighter-rouge">growing</code>: Animations that introduce mobjects to scene by growing them from points.</li>
  <li><code class="language-plaintext highlighter-rouge">indication</code>:Animations drawing attention to particular mobjects.</li>
  <li><code class="language-plaintext highlighter-rouge">movement</code>: Animations related to movement.</li>
  <li><code class="language-plaintext highlighter-rouge">numbers</code>: Animations for changing numbers.</li>
  <li><code class="language-plaintext highlighter-rouge">rotation</code>: Animations related to rotation.</li>
  <li><code class="language-plaintext highlighter-rouge">specialized</code>:</li>
  <li><code class="language-plaintext highlighter-rouge">speedmodifier</code>: Utilities for modifying the speed at which animations are played.</li>
  <li><code class="language-plaintext highlighter-rouge">transform</code>: Animations transforming one mobject into another.</li>
  <li><code class="language-plaintext highlighter-rouge">transform_matching_parts</code>: Animations that try to transform Mobjects while keeping track of identical parts.</li>
  <li><code class="language-plaintext highlighter-rouge">updaters</code>:Animations and utility mobjects related to update functions.</li>
</ul>

<p>Each <strong>animation</strong> method has its functions and you need to refer to the document
to figure out how to use them. For instance, if you want to <code class="language-plaintext highlighter-rouge">fading</code> some <code class="language-plaintext highlighter-rouge">Mobject</code>,
you can do:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">manim</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Fading</span><span class="p">(</span><span class="n">Scene</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tex_in</span> <span class="o">=</span> <span class="n">Tex</span><span class="p">(</span><span class="s">"Fade"</span><span class="p">,</span> <span class="s">"In"</span><span class="p">).</span><span class="n">scale</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">tex_out</span> <span class="o">=</span> <span class="n">Tex</span><span class="p">(</span><span class="s">"Fade"</span><span class="p">,</span> <span class="s">"Out"</span><span class="p">).</span><span class="n">scale</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">play</span><span class="p">(</span><span class="n">FadeIn</span><span class="p">(</span><span class="n">tex_in</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="n">DOWN</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.66</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">play</span><span class="p">(</span><span class="n">ReplacementTransform</span><span class="p">(</span><span class="n">tex_in</span><span class="p">,</span> <span class="n">tex_out</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">play</span><span class="p">(</span><span class="n">FadeOut</span><span class="p">(</span><span class="n">tex_out</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="n">DOWN</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">))</span>
</code></pre></div></div>

<h2 id="examples">Examples</h2>

<p>Every time you want to create a video with <code class="language-plaintext highlighter-rouge">manim</code>, you need to think about</p>

<ul>
  <li>what kind of <code class="language-plaintext highlighter-rouge">Mobject</code> do you need?</li>
  <li>what kind of attributes of <code class="language-plaintext highlighter-rouge">Mobject</code> do you need?</li>
  <li>how can you animate those <code class="language-plaintext highlighter-rouge">Mobject</code> by calling different kinds of animation
methods</li>
</ul>

<div class="figure">
    <img src="/images/blog/manim2.png" alt="A big picture" style="width: 80%; display: block; margin: 0 auto;" />
    <div class="caption">
        <span class="caption-label">Figure 2.</span> Big Picture of Manim
    </div>
</div>

<h2 id="gradient-descent-visualization-version-1">Gradient descent visualization: version 1</h2>

<p>To visualize the gradient descent process, we need to the following <code class="language-plaintext highlighter-rouge">Mobject</code>:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">graphing</code> - <code class="language-plaintext highlighter-rouge">coordinate_systems</code> - <code class="language-plaintext highlighter-rouge">Axes</code></li>
  <li><code class="language-plaintext highlighter-rouge">text</code> - <code class="language-plaintext highlighter-rouge">numbers</code> - <code class="language-plaintext highlighter-rouge">Variable</code></li>
</ul>

<p>To animate the object, we could use:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">animate</code></li>
  <li><code class="language-plaintext highlighter-rouge">add_updater</code></li>
</ul>

<iframe width="560" height="315" src="https://www.youtube.com/embed/X1Ma4JK-YV4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<p>To learn how to use <code class="language-plaintext highlighter-rouge">Axes</code>, you can either read the <a href="https://docs.manim.community/en/stable/reference/manim.mobject.graphing.coordinate_systems.Axes.html#axes" target="_blank">document</a> or read the <a href="https://docs.manim.community/en/stable/_modules/manim/mobject/graphing/coordinate_systems.html#Axes" target="_blank">source code</a>. I think
reading <code class="language-plaintext highlighter-rouge">source code</code> is more efficient as it gives you every parameter and 
method you can utilize for this <code class="language-plaintext highlighter-rouge">Axes</code> class.</p>

<p>Here is the code:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">NONE</span>
<span class="kn">from</span> <span class="nn">manim</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c1"># import all packages from manim
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>


<span class="k">class</span> <span class="nc">GradientDescent</span><span class="p">(</span><span class="n">Scene</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># construct the axes
</span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">Axes</span><span class="p">(</span>
            <span class="n">x_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
            <span class="n">y_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
        <span class="p">).</span><span class="n">add_coordinates</span><span class="p">()</span>
        
        <span class="c1"># plot the function
</span>        <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">3</span>
        <span class="n">func_graph</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">BLUE</span><span class="p">)</span>
        
        <span class="c1"># add function label
</span>        <span class="n">func_label</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">get_graph_label</span><span class="p">(</span>
            <span class="n">func_graph</span><span class="p">,</span> <span class="s">"f(x) = x^2-2x -3"</span><span class="p">,</span> <span class="n">x_val</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="n">UP</span>
        <span class="p">)</span>
        <span class="c1"># add a vertical line of the minimum value
</span>        <span class="n">line_1</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">get_vertical_line</span><span class="p">(</span><span class="n">ax</span><span class="p">.</span><span class="n">i2gp</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">func_graph</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">YELLOW</span><span class="p">)</span>
        
        <span class="c1"># derivate function and plot 
</span>        <span class="k">def</span> <span class="nf">derivate</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span>
        <span class="n">derivate_graph</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">derivate</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"#F8A331"</span><span class="p">)</span>
        <span class="n">derivate_label</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">get_graph_label</span><span class="p">(</span>
            <span class="n">derivate_graph</span><span class="p">,</span> <span class="s">"f'(x) = 2x-2"</span><span class="p">,</span> <span class="n">x_val</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="n">UP</span><span class="o">*</span><span class="mi">6</span>
        <span class="p">)</span>
        
        <span class="c1"># gradient descent variable with alpha = 0.03, iteration = 50
</span>        <span class="c1"># iteration tracker
</span>        <span class="n">iteration</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Text</span><span class="p">(</span><span class="s">"Iteration"</span><span class="p">),</span> <span class="n">num_decimal_places</span><span class="o">=</span><span class="mi">0</span><span class="p">).</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
        
        <span class="c1"># learning rate
</span>        <span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.97</span>
        <span class="n">learning_rate_var</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">learning_rate</span><span class="p">,</span> 
                                     <span class="n">MathTex</span><span class="p">(</span><span class="sa">r</span><span class="s">"\alpha"</span><span class="p">),</span> 
                                     <span class="n">num_decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">).</span><span class="n">shift</span><span class="p">(</span><span class="n">UP</span><span class="o">*</span><span class="mf">3.2</span><span class="o">+</span><span class="n">LEFT</span><span class="o">*</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">learning_rate_var</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">RED</span><span class="p">)</span>
        
        <span class="c1"># theta 
</span>        <span class="n">theta</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">theta_var</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="sa">r</span><span class="s">"\theta_t"</span><span class="p">,</span> <span class="n">num_decimal_places</span><span class="o">=</span><span class="mi">3</span><span class="p">).</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="n">theta_var</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">GREEN</span><span class="p">)</span>
        <span class="n">theta_var_update</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="sa">r</span><span class="s">"\theta_{t+1}"</span><span class="p">,</span> <span class="n">num_decimal_places</span><span class="o">=</span><span class="mi">3</span><span class="p">).</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="n">theta_var_update</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">GREEN</span><span class="p">)</span>
        <span class="n">theta_var</span><span class="p">.</span><span class="n">shift</span><span class="p">(</span><span class="n">DOWN</span><span class="o">*</span><span class="mf">2.7</span><span class="o">+</span><span class="n">RIGHT</span><span class="o">*</span><span class="mf">3.4</span><span class="p">)</span>
        <span class="n">theta_var_update</span><span class="p">.</span><span class="n">shift</span><span class="p">(</span><span class="n">DOWN</span><span class="o">*</span><span class="mf">3.3</span><span class="o">+</span><span class="n">RIGHT</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
        
        <span class="c1"># function
</span>        <span class="k">def</span> <span class="nf">constant_one</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span>
        <span class="c1"># update theta_var
</span>        <span class="n">theta_var</span><span class="p">.</span><span class="n">add_updater</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="n">tracker</span><span class="p">.</span><span class="n">set_value</span><span class="p">(</span>
            <span class="p">(</span><span class="n">theta_var</span><span class="p">.</span><span class="n">tracker</span><span class="p">.</span><span class="n">get_value</span><span class="p">()</span><span class="o">-</span>
             <span class="n">learning_rate</span><span class="o">*</span><span class="n">constant_one</span><span class="p">(</span><span class="n">iteration</span><span class="p">.</span><span class="n">tracker</span><span class="p">.</span><span class="n">get_value</span><span class="p">())</span><span class="o">*</span>
             <span class="n">derivate</span><span class="p">(</span><span class="n">theta_var</span><span class="p">.</span><span class="n">tracker</span><span class="p">.</span><span class="n">get_value</span><span class="p">()))</span>
        <span class="p">))</span> 
        
        <span class="c1"># update theta_var_update
</span>        <span class="n">theta_var_update</span><span class="p">.</span><span class="n">add_updater</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="n">tracker</span><span class="p">.</span><span class="n">set_value</span><span class="p">(</span>
            <span class="p">(</span><span class="n">theta_var</span><span class="p">.</span><span class="n">tracker</span><span class="p">.</span><span class="n">get_value</span><span class="p">()</span><span class="o">-</span>
             <span class="n">learning_rate</span><span class="o">*</span><span class="n">constant_one</span><span class="p">(</span><span class="n">iteration</span><span class="p">.</span><span class="n">tracker</span><span class="p">.</span><span class="n">get_value</span><span class="p">())</span><span class="o">*</span>
             <span class="n">derivate</span><span class="p">(</span><span class="n">theta_var</span><span class="p">.</span><span class="n">tracker</span><span class="p">.</span><span class="n">get_value</span><span class="p">()))</span>
        <span class="p">))</span>
        
        <span class="c1"># add gradient descent formula 
</span>        <span class="n">update_rule</span> <span class="o">=</span> <span class="n">MathTex</span><span class="p">(</span><span class="sa">r</span><span class="s">"\theta_{t+1} = \theta_t - \alpha f'(x)"</span><span class="p">)</span>
        <span class="n">iter_update_group</span> <span class="o">=</span> <span class="n">Group</span><span class="p">(</span><span class="n">iteration</span><span class="p">,</span> <span class="n">update_rule</span><span class="p">).</span><span class="n">arrange</span><span class="p">(</span><span class="n">DOWN</span><span class="p">).</span><span class="n">shift</span><span class="p">(</span><span class="n">DOWN</span><span class="o">*</span><span class="mf">1.7</span><span class="o">+</span><span class="n">RIGHT</span><span class="o">*</span><span class="mf">3.9</span><span class="p">)</span>
        
        <span class="c1"># add moving point
</span>        <span class="n">mp</span> <span class="o">=</span> <span class="n">theta_var_update</span><span class="p">.</span><span class="n">tracker</span>
        <span class="n">mp_initial_point</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span><span class="p">.</span><span class="n">coords_to_point</span><span class="p">(</span><span class="n">mp</span><span class="p">.</span><span class="n">get_value</span><span class="p">(),</span> <span class="n">func</span><span class="p">(</span><span class="n">mp</span><span class="p">.</span><span class="n">get_value</span><span class="p">()))]</span>
        <span class="n">mp_dot</span> <span class="o">=</span> <span class="n">Dot</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="n">mp_initial_point</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">BLUE</span><span class="p">,</span> <span class="n">fill_opacity</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                     <span class="n">radius</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
        <span class="n">mp_dot</span><span class="p">.</span><span class="n">add_updater</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="n">move_to</span><span class="p">(</span><span class="n">ax</span><span class="p">.</span><span class="n">c2p</span><span class="p">(</span>
            <span class="n">mp</span><span class="p">.</span><span class="n">get_value</span><span class="p">(),</span>
            <span class="n">func</span><span class="p">(</span><span class="n">mp</span><span class="p">.</span><span class="n">get_value</span><span class="p">())</span>
        <span class="p">)))</span>
        <span class="c1"># add theta moving point
</span>        <span class="n">mp_theta_init</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span><span class="p">.</span><span class="n">c2p</span><span class="p">(</span><span class="n">mp</span><span class="p">.</span><span class="n">get_value</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)]</span>
        <span class="n">mp_theta_dot</span> <span class="o">=</span> <span class="n">Dot</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="n">mp_theta_init</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">GREEN</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
        <span class="n">mp_theta_dot</span><span class="p">.</span><span class="n">add_updater</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="n">move_to</span><span class="p">(</span><span class="n">ax</span><span class="p">.</span><span class="n">c2p</span><span class="p">(</span>
            <span class="n">mp</span><span class="p">.</span><span class="n">get_value</span><span class="p">(),</span>
            <span class="mi">0</span>
        <span class="p">)))</span>
        
        <span class="c1"># add derivative variable
</span>        <span class="n">derivate_var</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span>
            <span class="n">derivate</span><span class="p">(</span><span class="n">theta_var</span><span class="p">.</span><span class="n">tracker</span><span class="p">.</span><span class="n">get_value</span><span class="p">()),</span>
            <span class="sa">r</span><span class="s">"f'(x)"</span><span class="p">,</span>
            <span class="n">num_decimal_places</span><span class="o">=</span><span class="mi">3</span>
        <span class="p">).</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.8</span><span class="p">).</span><span class="n">shift</span><span class="p">(</span><span class="n">DOWN</span><span class="o">*</span><span class="mf">1.5</span><span class="o">+</span><span class="n">LEFT</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">derivate_var</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">"#F8A331"</span><span class="p">)</span>
        <span class="n">derivate_var</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">"#F8A331"</span><span class="p">)</span>
        
        <span class="n">derivate_var</span><span class="p">.</span><span class="n">add_updater</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="n">tracker</span><span class="p">.</span><span class="n">set_value</span><span class="p">(</span>
            <span class="n">derivate</span><span class="p">(</span><span class="n">mp</span><span class="p">.</span><span class="n">get_value</span><span class="p">())</span>
        <span class="p">))</span>
        
        <span class="c1"># add function variable
</span>        <span class="n">func_var</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span>
            <span class="n">func</span><span class="p">(</span><span class="n">mp</span><span class="p">.</span><span class="n">get_value</span><span class="p">()),</span>
            <span class="sa">r</span><span class="s">"f(x)"</span><span class="p">,</span>
            <span class="n">num_decimal_places</span><span class="o">=</span><span class="mi">3</span>
        <span class="p">).</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.8</span><span class="p">).</span><span class="n">shift</span><span class="p">(</span><span class="n">UP</span><span class="o">*</span><span class="mf">2.5</span><span class="o">+</span><span class="n">LEFT</span><span class="o">*</span><span class="mf">6.4</span><span class="p">)</span>
        <span class="n">func_var</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">BLUE</span><span class="p">)</span>
        <span class="n">func_var</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">BLUE</span><span class="p">)</span>
        
        <span class="n">func_var</span><span class="p">.</span><span class="n">add_updater</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="n">tracker</span><span class="p">.</span><span class="n">set_value</span><span class="p">(</span>
            <span class="n">func</span><span class="p">(</span><span class="n">mp</span><span class="p">.</span><span class="n">get_value</span><span class="p">())</span>
        <span class="p">))</span>
        
        <span class="c1"># add all objects 
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">func_graph</span><span class="p">,</span> <span class="n">func_label</span><span class="p">,</span> <span class="n">line_1</span><span class="p">,</span>
                 <span class="n">mp_dot</span><span class="p">,</span> <span class="n">mp_theta_dot</span><span class="p">,</span>
                 <span class="n">derivate_graph</span><span class="p">,</span> <span class="n">derivate_label</span><span class="p">,</span>
                 <span class="n">learning_rate_var</span><span class="p">,</span>
                 <span class="n">iter_update_group</span><span class="p">,</span>
                 <span class="n">func_var</span><span class="p">,</span> <span class="n">derivate_var</span><span class="p">,</span>
                 <span class="n">theta_var</span><span class="p">,</span> <span class="n">theta_var_update</span><span class="p">)</span>
        
        
        <span class="bp">self</span><span class="p">.</span><span class="n">play</span><span class="p">(</span><span class="n">iteration</span><span class="p">.</span><span class="n">tracker</span><span class="p">.</span><span class="n">animate</span><span class="p">.</span><span class="n">set_value</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span> <span class="n">run_time</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="gradient-descent-visualization-version-2">Gradient descent visualization: version 2</h2>

<p>when you watch the first video, you can notice that the iteration and $\theta$ 
are not updating with the same rate. This happens due to the <code class="language-plaintext highlighter-rouge">add_updater</code> function,
which is defined as:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Scene</span><span class="p">:</span>
    <span class="s">"""A Scene is the canvas of your animation.

    The primary role of :class:`Scene` is to provide the user with tools to 
    manage mobjects and animations.  Generally speaking, a manim script 
    consists of a class that derives from :class:`Scene` 
    whose :meth:`Scene.construct` method is overridden by the user's code.
    """</span> 
    <span class="c1"># ...
</span>    <span class="c1"># ...
</span>    <span class="k">def</span> <span class="nf">add_updater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="bp">None</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="s">"""Add an update function to the scene.

        The scene updater functions are run every frame,
        and they are the last type of updaters to run.
        """</span>
</code></pre></div></div>

<iframe width="560" height="315" src="https://www.youtube.com/embed/VLlRqUK8ffA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<p>The above video works well as the iteration and $\theta$ are updating at
the same rate. This version uses <code class="language-plaintext highlighter-rouge">always_redraw</code> function which makes each
frame to update with the same value of <code class="language-plaintext highlighter-rouge">iteration</code>. However it takes much more
time to create the video as it needs to create more scenes.</p>

<p>Here is the source code:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">NONE</span>
<span class="kn">from</span> <span class="nn">manim</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c1"># import all packages from manim
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>


<span class="k">class</span> <span class="nc">GradientDescent</span><span class="p">(</span><span class="n">Scene</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="c1"># add Axes object
</span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">Axes</span><span class="p">(</span>
            <span class="n">x_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
            <span class="n">y_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
        <span class="p">).</span><span class="n">add_coordinates</span><span class="p">()</span>
        
        <span class="c1"># plot the function
</span>        <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">3</span>
        <span class="n">func_graph</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">BLUE</span><span class="p">)</span>
        
        <span class="c1"># add function label
</span>        <span class="n">func_label</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">get_graph_label</span><span class="p">(</span>
            <span class="n">func_graph</span><span class="p">,</span> <span class="s">"f(x) = x^2-2x -3"</span><span class="p">,</span> <span class="n">x_val</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="n">UP</span>
        <span class="p">)</span>
        <span class="c1"># add a vertical line of the minimum value
</span>        <span class="n">line_1</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">get_vertical_line</span><span class="p">(</span><span class="n">ax</span><span class="p">.</span><span class="n">i2gp</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">func_graph</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">YELLOW</span><span class="p">)</span>
        
        <span class="c1"># derivate function and plot 
</span>        <span class="k">def</span> <span class="nf">derivate</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span>
        <span class="n">derivate_graph</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">derivate</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"#F8A331"</span><span class="p">)</span>
        <span class="n">derivate_label</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">get_graph_label</span><span class="p">(</span>
            <span class="n">derivate_graph</span><span class="p">,</span> <span class="s">"f'(x) = 2x-2"</span><span class="p">,</span> <span class="n">x_val</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="n">UP</span><span class="o">*</span><span class="mi">6</span>
        <span class="p">)</span>
        
        <span class="c1"># gradient descent variable with alpha = 0.03, iteration = 50
</span>        
        <span class="c1"># add learning rate on the top of scene
</span>        <span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.97</span>
        <span class="n">learning_rate_var</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">learning_rate</span><span class="p">,</span> 
                                     <span class="n">MathTex</span><span class="p">(</span><span class="sa">r</span><span class="s">"\alpha"</span><span class="p">),</span> 
                                     <span class="n">num_decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">).</span><span class="n">shift</span><span class="p">(</span><span class="n">UP</span><span class="o">*</span><span class="mf">3.2</span><span class="o">+</span><span class="n">LEFT</span><span class="o">*</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">learning_rate_var</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">RED</span><span class="p">)</span>
        
        <span class="c1"># iteration tracker
</span>        <span class="n">iteration</span> <span class="o">=</span> <span class="n">ValueTracker</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># start from 1 
</span>        
        <span class="c1"># add iteration text 
</span>        <span class="n">iteration_text</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">Text</span><span class="p">(</span><span class="s">"Iteration: "</span><span class="p">).</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="p">.</span><span class="n">shift</span><span class="p">(</span><span class="n">DOWN</span><span class="o">*</span><span class="mf">1.3</span><span class="o">+</span><span class="n">RIGHT</span><span class="o">*</span><span class="mf">3.7</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">iteration_value</span> <span class="o">=</span> <span class="n">always_redraw</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">DecimalNumber</span><span class="p">(</span><span class="n">num_decimal_places</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="p">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">iteration</span><span class="p">.</span><span class="n">get_value</span><span class="p">())</span>
            <span class="p">.</span><span class="n">next_to</span><span class="p">(</span><span class="n">iteration_text</span><span class="p">,</span> <span class="n">RIGHT</span><span class="p">,</span> <span class="n">buff</span><span class="o">=</span><span class="mf">0.2</span><span class="p">).</span><span class="n">shift</span><span class="p">(</span><span class="n">DOWN</span><span class="o">*</span><span class="mf">0.03</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># add gradient descent formula below the iteration
</span>        <span class="n">update_rule</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">MathTex</span><span class="p">(</span><span class="sa">r</span><span class="s">"\theta_{t+1} = \theta_t - \alpha f'(x)"</span><span class="p">)</span>
            <span class="p">.</span><span class="n">shift</span><span class="p">(</span><span class="n">DOWN</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="n">RIGHT</span><span class="o">*</span><span class="mf">3.9</span><span class="p">)</span>
        <span class="p">)</span>
                    
        <span class="c1"># add theta and theta_update
</span>        <span class="n">theta_text</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">MathTex</span><span class="p">(</span><span class="sa">r</span><span class="s">"\theta_t = "</span><span class="p">).</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="p">.</span><span class="n">shift</span><span class="p">(</span><span class="n">DOWN</span><span class="o">*</span><span class="mf">2.6</span><span class="o">+</span><span class="n">RIGHT</span><span class="o">*</span><span class="mf">3.9</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># initialize the theta value
</span>        <span class="n">initial_theta</span> <span class="o">=</span> <span class="mf">4.0</span>
        
        <span class="c1"># helper function
</span>        <span class="k">def</span> <span class="nf">update_theta_t</span><span class="p">(</span><span class="n">initial_value</span><span class="p">,</span> <span class="n">tracker_value</span><span class="p">):</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">initial_value</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">tracker_value</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">-</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">derivate</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">theta</span>
        
        <span class="n">theta_value</span> <span class="o">=</span> <span class="n">always_redraw</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">DecimalNumber</span><span class="p">(</span><span class="n">num_decimal_places</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="p">.</span><span class="n">set_value</span><span class="p">(</span>
                <span class="n">update_theta_t</span><span class="p">(</span><span class="n">initial_theta</span><span class="p">,</span> <span class="n">iteration</span><span class="p">.</span><span class="n">get_value</span><span class="p">())</span>
            <span class="p">)</span>
            <span class="p">.</span><span class="n">next_to</span><span class="p">(</span><span class="n">theta_text</span><span class="p">,</span> <span class="n">RIGHT</span><span class="p">,</span> <span class="n">buff</span><span class="o">=</span><span class="mf">0.1</span><span class="p">).</span><span class="n">shift</span><span class="p">(</span><span class="n">DOWN</span><span class="o">*</span><span class="mf">0.01</span><span class="p">)</span>
            <span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">GREEN</span><span class="p">)</span>
            <span class="p">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># add theta_t+1
</span>        <span class="n">theta_update_text</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">MathTex</span><span class="p">(</span><span class="sa">r</span><span class="s">"\theta_{t+1} = "</span><span class="p">).</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="p">.</span><span class="n">shift</span><span class="p">(</span><span class="n">DOWN</span><span class="o">*</span><span class="mf">3.2</span><span class="o">+</span><span class="n">RIGHT</span><span class="o">*</span><span class="mf">2.7</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">theta_update_value</span> <span class="o">=</span> <span class="n">always_redraw</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">DecimalNumber</span><span class="p">(</span><span class="n">num_decimal_places</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="p">.</span><span class="n">set_value</span><span class="p">(</span>
                <span class="n">update_theta_t</span><span class="p">(</span><span class="n">initial_theta</span><span class="p">,</span> <span class="n">iteration</span><span class="p">.</span><span class="n">get_value</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="p">.</span><span class="n">next_to</span><span class="p">(</span><span class="n">theta_update_text</span><span class="p">,</span> <span class="n">RIGHT</span><span class="p">,</span> <span class="n">buff</span><span class="o">=</span><span class="mf">0.1</span><span class="p">).</span><span class="n">shift</span><span class="p">(</span><span class="n">UP</span><span class="o">*</span><span class="mf">0.01</span><span class="p">)</span>
            <span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">GREEN</span><span class="p">)</span>
            <span class="p">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># add derivative value
</span>        <span class="n">derivate_text</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">MathTex</span><span class="p">(</span><span class="sa">r</span><span class="s">"f'(x) = "</span><span class="p">).</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="p">.</span><span class="n">shift</span><span class="p">(</span><span class="n">DOWN</span><span class="o">*</span><span class="mf">1.5</span><span class="o">+</span><span class="n">LEFT</span><span class="o">*</span><span class="mf">5.6</span><span class="p">)</span>
            <span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">"#F8A331"</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="k">def</span> <span class="nf">update_derivate_value</span><span class="p">(</span><span class="n">tracker_value</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">update_theta_t</span><span class="p">(</span><span class="n">initial_theta</span><span class="p">,</span> <span class="n">tracker_value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">derivate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            
        <span class="n">derivate_text_value</span> <span class="o">=</span> <span class="n">always_redraw</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">DecimalNumber</span><span class="p">(</span><span class="n">num_decimal_places</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="p">.</span><span class="n">set_value</span><span class="p">(</span>
                <span class="n">update_derivate_value</span><span class="p">(</span><span class="n">iteration</span><span class="p">.</span><span class="n">get_value</span><span class="p">())</span>
            <span class="p">)</span>
            <span class="p">.</span><span class="n">next_to</span><span class="p">(</span><span class="n">derivate_text</span><span class="p">,</span> <span class="n">RIGHT</span><span class="p">,</span> <span class="n">buff</span><span class="o">=</span><span class="mf">0.1</span><span class="p">).</span><span class="n">shift</span><span class="p">(</span><span class="n">UP</span><span class="o">*</span><span class="mf">0.01</span><span class="p">)</span>
            <span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">"#F8A331"</span><span class="p">)</span>
            <span class="p">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># add function value
</span>        <span class="n">func_text</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">MathTex</span><span class="p">(</span><span class="sa">r</span><span class="s">"f(x) = "</span><span class="p">).</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="p">.</span><span class="n">shift</span><span class="p">(</span><span class="n">UP</span><span class="o">*</span><span class="mf">2.5</span><span class="o">+</span><span class="n">LEFT</span><span class="o">*</span><span class="mf">5.9</span><span class="p">)</span>
            <span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">BLUE</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="k">def</span> <span class="nf">update_func_value</span><span class="p">(</span><span class="n">tracker_value</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">update_theta_t</span><span class="p">(</span><span class="n">initial_theta</span><span class="p">,</span> <span class="n">tracker_value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        
        <span class="n">func_text_value</span> <span class="o">=</span> <span class="n">always_redraw</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">DecimalNumber</span><span class="p">(</span><span class="n">num_decimal_places</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="p">.</span><span class="n">set_value</span><span class="p">(</span>
                <span class="n">update_func_value</span><span class="p">(</span><span class="n">iteration</span><span class="p">.</span><span class="n">get_value</span><span class="p">())</span>
            <span class="p">)</span>
            <span class="p">.</span><span class="n">next_to</span><span class="p">(</span><span class="n">func_text</span><span class="p">,</span> <span class="n">RIGHT</span><span class="p">,</span> <span class="n">buff</span><span class="o">=</span><span class="mf">0.1</span><span class="p">).</span><span class="n">shift</span><span class="p">(</span><span class="n">UP</span><span class="o">*</span><span class="mf">0.01</span><span class="p">)</span>
            <span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">BLUE</span><span class="p">)</span>
            <span class="p">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># add moving point on graph
</span>        <span class="c1"># helper function
</span>        <span class="k">def</span> <span class="nf">mp_coordinate</span><span class="p">(</span><span class="n">tracker_value</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">update_theta_t</span><span class="p">(</span><span class="n">initial_theta</span><span class="p">,</span> <span class="n">tracker_value</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
        
        <span class="n">mp0</span> <span class="o">=</span> <span class="n">always_redraw</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">Dot</span><span class="p">(</span>
                <span class="n">point</span><span class="o">=</span><span class="p">[</span><span class="n">ax</span><span class="p">.</span><span class="n">c2p</span><span class="p">(</span><span class="n">theta_value</span><span class="p">.</span><span class="n">get_value</span><span class="p">(),</span> <span class="n">func</span><span class="p">(</span><span class="n">theta_value</span><span class="p">.</span><span class="n">get_value</span><span class="p">()))],</span>
                <span class="n">color</span><span class="o">=</span><span class="n">BLUE</span><span class="p">,</span>
                <span class="n">fill_opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.15</span>
                <span class="p">).</span><span class="n">move_to</span><span class="p">(</span>
                    <span class="n">ax</span><span class="p">.</span><span class="n">c2p</span><span class="p">(</span>
                        <span class="n">mp_coordinate</span><span class="p">(</span><span class="n">iteration</span><span class="p">.</span><span class="n">get_value</span><span class="p">())[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">mp_coordinate</span><span class="p">(</span><span class="n">iteration</span><span class="p">.</span><span class="n">get_value</span><span class="p">())[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">mp1</span> <span class="o">=</span> <span class="n">always_redraw</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">Dot</span><span class="p">(</span>
                <span class="n">point</span><span class="o">=</span><span class="p">[</span><span class="n">ax</span><span class="p">.</span><span class="n">c2p</span><span class="p">(</span><span class="n">theta_value</span><span class="p">.</span><span class="n">get_value</span><span class="p">(),</span> <span class="n">func</span><span class="p">(</span><span class="n">theta_value</span><span class="p">.</span><span class="n">get_value</span><span class="p">()))],</span>
                <span class="n">color</span><span class="o">=</span><span class="n">GREEN</span><span class="p">,</span>
                <span class="n">fill_opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.15</span>
                <span class="p">).</span><span class="n">move_to</span><span class="p">(</span>
                    <span class="n">ax</span><span class="p">.</span><span class="n">c2p</span><span class="p">(</span>
                        <span class="n">mp_coordinate</span><span class="p">(</span><span class="n">iteration</span><span class="p">.</span><span class="n">get_value</span><span class="p">())[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="mi">0</span>
                    <span class="p">)</span>
                <span class="p">)</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">func_graph</span><span class="p">,</span> <span class="n">func_label</span><span class="p">,</span> <span class="n">line_1</span><span class="p">,</span>
                 <span class="n">derivate_graph</span><span class="p">,</span> <span class="n">derivate_label</span><span class="p">,</span>
                 <span class="n">learning_rate_var</span><span class="p">,</span>
                 <span class="n">iteration_text</span><span class="p">,</span> <span class="n">iteration_value</span><span class="p">,</span>
                 <span class="n">update_rule</span><span class="p">,</span>
                 <span class="n">theta_text</span><span class="p">,</span> <span class="n">theta_value</span><span class="p">,</span>
                 <span class="n">theta_update_text</span><span class="p">,</span> <span class="n">theta_update_value</span><span class="p">,</span>
                 <span class="n">derivate_text</span><span class="p">,</span> <span class="n">derivate_text_value</span><span class="p">,</span>
                 <span class="n">func_text</span><span class="p">,</span> <span class="n">func_text_value</span><span class="p">,</span>
                 <span class="n">mp0</span><span class="p">,</span> <span class="n">mp1</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">play</span><span class="p">(</span><span class="n">iteration</span><span class="p">.</span><span class="n">animate</span><span class="p">.</span><span class="n">set_value</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span> <span class="n">run_time</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">rate_func</span><span class="o">=</span><span class="n">linear</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>
</code></pre></div></div>

    </div>
    <div id='bibliography'>
        <div class='wrap'>
            <ol class="bibliography"></ol>
        </div>
    </div>
</div>
</body>
<script>
var lis = document.getElementsByClassName("footnotes")
for (let i = 0; i < lis.length; i++){
    var li_tag = lis[i].getElementsByTagName('li')

    for (let j = 0; j < li_tag.length; j++) {
        li_tag[j].setAttribute('role', 'link')
    }
    var a_tag = lis[i].getElementsByTagName('a')

    for (let k = 0; k < a_tag.length; k++) {
        a_tag[k].setAttribute('role', 'link')
    }
}
</script>
</html>