<!DOCTYPE html>
<html lang="en">
<head>
    <html lang="en">
  <head>
    <title>
      CORDIS - EU Research Projects Datasets
    </title>
    <meta charset='UTF-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name='author' content='Michael Wang Fei'>
    <meta name='keywords' content='
          machine learning,
          statistical machine learning,
          bayesian inference,
          statistics,
          computational statistics,
          linear algebra,
          numerical linear algebra,
          statistical software,
          deep learning,
          computer science,
          probability,
          math,
          mathematics,
          probabilistic reasoning
      '>
      <meta name='keywords' content='business analytic, CORDIS, Orbis, matching, WRDS, database, string-matching, open-data'>
      <link rel="stylesheet" href="/css/blog.css">
      <link rel="stylesheet" href="/css/markdown.css">
      <link rel="stylesheet" href="/css/trac.css">
      <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
      <!-- The loading of KaTeX is deferred to speed up page rendering -->
      <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
      <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
      <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>CORDIS - EU Research Projects Datasets</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="CORDIS - EU Research Projects Datasets" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The Community Research and Development Information Service (CORDIS) is the European Commission’s primary source of results from the projects funded by the EU’s framework programs for research and innovation, from FP1 to Horizon Europe." />
<meta property="og:description" content="The Community Research and Development Information Service (CORDIS) is the European Commission’s primary source of results from the projects funded by the EU’s framework programs for research and innovation, from FP1 to Horizon Europe." />
<link rel="canonical" href="https://oceanumeric.github.io//blog/cordis-dataset" />
<meta property="og:url" content="https://oceanumeric.github.io//blog/cordis-dataset" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-02-19T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="CORDIS - EU Research Projects Datasets" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-02-19T00:00:00+00:00","datePublished":"2023-02-19T00:00:00+00:00","description":"The Community Research and Development Information Service (CORDIS) is the European Commission’s primary source of results from the projects funded by the EU’s framework programs for research and innovation, from FP1 to Horizon Europe.","headline":"CORDIS - EU Research Projects Datasets","mainEntityOfPage":{"@type":"WebPage","@id":"https://oceanumeric.github.io//blog/cordis-dataset"},"url":"https://oceanumeric.github.io//blog/cordis-dataset"}</script>
<!-- End Jekyll SEO tag -->

  </head>
</html>


</head>
<body>
<div class='content'>
    <!DOCTYPE html>
<div class='nav'>
    <ul class='wrap'>
        <li><a href='/'>Home</a></li>
        <li><a href='/blog'>Blog</a></li>
        <li><a href='/math'>Math</a></li>
        <li><a href='/tags'>Tags</a></li>
    </ul>
</div>
</html>

    <div class='front-matter'>
        <div class='wrap'>
            <h1>CORDIS - EU Research Projects Datasets</h1>
            <h4>The dataset contains all projects funded by the European Union from 1998 to 2027, I organized those datasets in this post for research purpose.</h4>
            <div class='bylines'>
                <div class='byline'>
                    
                    
                        <span class="post-tags">
                            <i class="fa fa-tags"></i>
                            
                            <a href="/blog-tags/data-science">data-science</a>, 
                            
                            <a href="/blog-tags/dataset">dataset</a>, 
                            
                            <a href="/blog-tags/python">python</a>, 
                            
                            <a href="/blog-tags/r">r</a>, 
                            
                            <a href="/blog-tags/business-analytics">business-analytics</a>, 
                            
                            <a href="/blog-tags/string-matching">string-matching</a>
                            
                        </span>
                    
                    <h3>Published</h3>
                    <p>19 February 2023</p>
                </div>
            </div>
            <div class='clear'></div>
        </div>
    </div>
    <div class='wrap article'>
        <p>The Community Research and Development Information Service (CORDIS) is the European Commission’s primary source of results from the projects funded by the EU’s framework programs for research and innovation, from FP1 to Horizon Europe.</p>

<p>I have downloaded the following datasets:</p>

<ul>
  <li>CORDIS - EU research projects under FP5 (1998-2002)</li>
  <li>CORDIS - EU research projects under FP6 (2002-2006)</li>
  <li>CORDIS - EU research projects under FP7 (2007-2013)</li>
  <li>CORDIS - EU research projects under Horizon 2020 (2014-2020)</li>
  <li>CORDIS - EU research projects under HORIZON EUROPE (2021-2027)</li>
</ul>

<p>You can download all datasets from <a href="https://www.kaggle.com/datasets/oceanumeric/cordis" target="_blank">kaggle</a>.</p>

<h2 id="horizon-2020-dataset">Horizon 2020 dataset</h2>

<div class="table-caption">
<span class="table-caption-label">Table 1.</span> Distribution of funded projects in terms of industry
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Industry</th>
      <th style="text-align: center">N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">computer and information sciences</td>
      <td style="text-align: center">4525</td>
    </tr>
    <tr>
      <td style="text-align: left">biological sciences</td>
      <td style="text-align: center">4454</td>
    </tr>
    <tr>
      <td style="text-align: left">physical sciences</td>
      <td style="text-align: center">2335</td>
    </tr>
    <tr>
      <td style="text-align: left">environmental engineering</td>
      <td style="text-align: center">2105</td>
    </tr>
    <tr>
      <td style="text-align: left">electronic engineering, information engineering</td>
      <td style="text-align: center">1784</td>
    </tr>
    <tr>
      <td style="text-align: left">chemical sciences</td>
      <td style="text-align: center">1739</td>
    </tr>
    <tr>
      <td style="text-align: left">sociology</td>
      <td style="text-align: center">1625</td>
    </tr>
    <tr>
      <td style="text-align: left">clinical medicine</td>
      <td style="text-align: center">1603</td>
    </tr>
    <tr>
      <td style="text-align: left">economics and business</td>
      <td style="text-align: center">1517</td>
    </tr>
    <tr>
      <td style="text-align: left">basic medicine</td>
      <td style="text-align: center">1340</td>
    </tr>
  </tbody>
</table>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load packages</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">pacman</span><span class="p">)</span><span class="w">
</span><span class="n">p_load</span><span class="p">(</span><span class="w">
    </span><span class="n">tidyverse</span><span class="p">,</span><span class="w"> </span><span class="n">data.table</span><span class="p">,</span><span class="w"> </span><span class="n">dtplyr</span><span class="p">,</span><span class="w"> </span><span class="n">reshape2</span><span class="p">,</span><span class="w">
    </span><span class="n">archive</span><span class="p">,</span><span class="w"> </span><span class="n">kableExtra</span><span class="p">,</span><span class="w"> </span><span class="n">SPARQL</span><span class="p">,</span><span class="w"> </span><span class="n">janitor</span><span class="p">,</span><span class="w">
    </span><span class="n">png</span><span class="p">,</span><span class="w"> </span><span class="n">webp</span><span class="p">,</span><span class="w"> </span><span class="n">Cairo</span><span class="p">,</span><span class="w"> </span><span class="n">rsvg</span><span class="p">,</span><span class="w"> </span><span class="n">rbenchmark</span><span class="p">,</span><span class="w">
    </span><span class="n">httr</span><span class="p">,</span><span class="w"> </span><span class="n">jsonlite</span><span class="p">,</span><span class="w"> </span><span class="n">fedmatch</span><span class="p">)</span><span class="w">
</span><span class="c1"># set option</span><span class="w">
</span><span class="n">options</span><span class="p">(</span><span class="n">dplyr.summarise.inform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w">

</span><span class="n">gray_scale</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"#F3F4F8"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#D2D4DA"</span><span class="p">,</span><span class="w">  </span><span class="s2">"#bcc0ca"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"#D3D3D3"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#2B2B2B"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"#B3B5BD"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#838383"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"#9496A1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#7d7f89"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#777986"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"#656673"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#5B5D6B"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#4d505e"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"#404352"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#2b2d3b"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#282A3A"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"#1b1c2a"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#191a2b"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#141626"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#101223"</span><span class="p">)</span><span class="w">

</span><span class="c1"># check working directory</span><span class="w">
</span><span class="n">getwd</span><span class="p">()</span><span class="w">


</span><span class="c1">########## ------- Create a merged dataset ----------- ###############</span><span class="w">
</span><span class="n">projects</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fread</span><span class="p">(</span><span class="s2">"./data/cordis_h2020/project.csv"</span><span class="p">)</span><span class="w">
</span><span class="n">org</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fread</span><span class="p">(</span><span class="s2">"./data/cordis_h2020/organization.csv"</span><span class="p">)</span><span class="w">
</span><span class="n">sv_tags</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fread</span><span class="p">(</span><span class="s2">"./data/cordis_h2020/euroSciVoc.csv"</span><span class="p">)</span><span class="w">

</span><span class="c1"># transform projects by selecting some columns</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">projects</span><span class="p">)</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">projects</span><span class="p">)[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"projectID"</span><span class="w">

</span><span class="n">projects</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">startYear</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">format</span><span class="p">(</span><span class="n">startDate</span><span class="p">,</span><span class="w"> </span><span class="s2">"%Y"</span><span class="p">))]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">endYear</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">format</span><span class="p">(</span><span class="n">endDate</span><span class="p">,</span><span class="w"> </span><span class="s2">"%Y"</span><span class="p">))]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w">
        </span><span class="s2">"projectID"</span><span class="p">,</span><span class="w"> </span><span class="s2">"startYear"</span><span class="p">,</span><span class="w"> </span><span class="s2">"endYear"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">,</span><span class="w"> </span><span class="s2">"title"</span><span class="p">,</span><span class="w"> </span><span class="s2">"topics"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"fundingScheme"</span><span class="p">,</span><span class="w"> </span><span class="s2">"grantDoi"</span><span class="p">)]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">projects_subset</span><span class="w">


</span><span class="c1"># view organization</span><span class="w">
</span><span class="n">org</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">sample</span><span class="p">(</span><span class="n">.N</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">)]</span><span class="w">


</span><span class="c1"># view sv_tas and # extract topics</span><span class="w">
</span><span class="n">sv_tags</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">)]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">svLevel1</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">tstrsplit</span><span class="p">(</span><span class="w">
        </span><span class="n">euroSciVocPath</span><span class="p">,</span><span class="w"> </span><span class="s2">"/"</span><span class="p">,</span><span class="w"> </span><span class="n">fixed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">keep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">))]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">svLevel2</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">tstrsplit</span><span class="p">(</span><span class="w">
        </span><span class="n">euroSciVocPath</span><span class="p">,</span><span class="w"> </span><span class="s2">"/"</span><span class="p">,</span><span class="w"> </span><span class="n">fixed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">keep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">))]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">sv_tags_levels</span><span class="w">

</span><span class="c1"># group by title</span><span class="w">
</span><span class="n">sv_tags_levels</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">)]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">lapply</span><span class="p">(</span><span class="n">.SD</span><span class="p">,</span><span class="w"> </span><span class="n">paste0</span><span class="p">,</span><span class="w">  </span><span class="n">collapse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"/"</span><span class="p">),</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">projectID</span><span class="p">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">sv_tags_title</span><span class="w">

</span><span class="c1"># merge and get unique</span><span class="w">
</span><span class="n">sv_tags_title</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">sv_tags_levels</span><span class="p">,</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="p">(</span><span class="n">projectID</span><span class="p">)]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">unique</span><span class="p">(</span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"projectID"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">)]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">sv_tags_sum</span><span class="w">


</span><span class="c1"># merge projects_sub, org and sv_tags_levels </span><span class="w">
</span><span class="n">projects_subset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">projects_subset</span><span class="p">,</span><span class="w"> </span><span class="n">sv_tags_sum</span><span class="p">,</span><span class="w">
                         </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"projectID"</span><span class="p">,</span><span class="w"> </span><span class="n">all.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">horizon</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">org</span><span class="p">,</span><span class="w"> </span><span class="n">projects_subset</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"projectID"</span><span class="p">,</span><span class="w"> </span><span class="n">all.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">


</span><span class="c1"># on projects level</span><span class="w">
</span><span class="n">projects_subset</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">.</span><span class="p">(</span><span class="n">svLevel2</span><span class="p">)]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">.N</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">=</span><span class="n">svLevel2</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">order</span><span class="p">(</span><span class="o">-</span><span class="n">rank</span><span class="p">(</span><span class="n">N</span><span class="p">))]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">head</span><span class="p">(</span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">kable</span><span class="p">(</span><span class="s2">"pipe"</span><span class="p">,</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"cl"</span><span class="p">)</span><span class="w">

</span><span class="c1"># one project is normally applied by many organizations </span><span class="w">
</span><span class="n">horizon</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">sample</span><span class="p">(</span><span class="n">.N</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">)]</span><span class="w">

</span><span class="nf">names</span><span class="p">(</span><span class="n">horizon</span><span class="p">)</span><span class="w">


</span><span class="c1"># filter out German firms</span><span class="w">
</span><span class="n">horizon</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="o">:</span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="m">23</span><span class="p">,</span><span class="w"> </span><span class="m">26</span><span class="p">,</span><span class="w"> </span><span class="m">27</span><span class="p">,</span><span class="w"> </span><span class="m">32</span><span class="p">,</span><span class="w"> </span><span class="m">33</span><span class="p">,</span><span class="w"> </span><span class="m">37</span><span class="p">)]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">totalCost</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">","</span><span class="p">,</span><span class="w"> </span><span class="s2">"."</span><span class="p">,</span><span class="w"> </span><span class="n">totalCost</span><span class="p">)]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">totalCost</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">totalCost</span><span class="p">)]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">country</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"DE"</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">activityType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"PRC"</span><span class="p">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">horizon_de_firms</span><span class="w">


</span><span class="nf">dim</span><span class="p">(</span><span class="n">horizon_de_firms</span><span class="p">)</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">horizon_de_firms</span><span class="p">)</span><span class="w">
</span><span class="n">horizon_de_firms</span><span class="p">[</span><span class="n">sample</span><span class="p">(</span><span class="n">.N</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">)]</span><span class="w">



</span><span class="c1">########## ------ Match names with Orbis dataset ------ #########</span><span class="w">
</span><span class="n">orbis_de</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fread</span><span class="p">(</span><span class="s2">"./data/orbis_de_firms.csv"</span><span class="p">)</span><span class="w">

</span><span class="n">orbis_de</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">.</span><span class="p">(</span><span class="n">bvdid</span><span class="p">,</span><span class="w"> </span><span class="n">name_internat</span><span class="p">,</span><span class="w"> </span><span class="n">category_of_company</span><span class="p">,</span><span class="w">
                </span><span class="n">city_internat</span><span class="p">,</span><span class="w"> </span><span class="n">postcode</span><span class="p">)]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="c1"># clean postcode</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">postcode</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"\\.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">postcode</span><span class="p">)]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="c1"># create another ID</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">orbisID</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">.I</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">cleaned_names</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">clean_strings</span><span class="p">(</span><span class="n">name_internat</span><span class="p">)]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">foo1</span><span class="w">

</span><span class="nf">names</span><span class="p">(</span><span class="n">foo1</span><span class="p">)</span><span class="w">

</span><span class="n">horizon_de_firms</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">horizonID</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">.I</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">cleaned_names</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">clean_strings</span><span class="p">(</span><span class="n">name</span><span class="p">)]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">foo2</span><span class="w">

</span><span class="nf">names</span><span class="p">(</span><span class="n">foo2</span><span class="p">)</span><span class="w">


</span><span class="c1">######## ----------- match fuzzy ------ #######</span><span class="w">
</span><span class="n">match_fuzzy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge_plus</span><span class="p">(</span><span class="n">data1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">foo1</span><span class="p">,</span><span class="w"> </span><span class="n">data2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">foo2</span><span class="p">,</span><span class="w">
                        </span><span class="n">by.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"cleaned_names"</span><span class="p">,</span><span class="w"> </span><span class="n">by.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"cleaned_names"</span><span class="p">,</span><span class="w">
                        </span><span class="n">match_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"fuzzy"</span><span class="p">,</span><span class="w">
                        </span><span class="n">unique_key_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"orbisID"</span><span class="p">,</span><span class="w">
                        </span><span class="n">unique_key_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"horizonID"</span><span class="p">)</span><span class="w">

</span><span class="nf">names</span><span class="p">(</span><span class="n">match_fuzzy</span><span class="p">)</span><span class="w">
</span><span class="n">match_fuzzy</span><span class="o">$</span><span class="n">match_evaluation</span><span class="w">

</span><span class="n">match_fuzzy</span><span class="o">$</span><span class="n">matches</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">postcode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">postCode</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">unique</span><span class="p">(</span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"organisationID"</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">horbis_de</span><span class="w">

</span><span class="n">horbis_de</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="nf">dim</span><span class="p">()</span><span class="w">  </span><span class="c1"># 1585</span><span class="w">

</span><span class="c1"># view match</span><span class="w">
</span><span class="n">horbis_de</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">.</span><span class="p">(</span><span class="n">city_internat</span><span class="p">,</span><span class="w"> </span><span class="n">postcode</span><span class="p">,</span><span class="w"> </span><span class="n">cleaned_names_1</span><span class="p">,</span><span class="w">
                    </span><span class="n">cleaned_names_2</span><span class="p">,</span><span class="w"> </span><span class="n">postCode</span><span class="p">,</span><span class="w"> </span><span class="n">city</span><span class="p">)]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">sample</span><span class="p">(</span><span class="n">.N</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">)]</span><span class="w">


</span><span class="n">horbis_de</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">category_of_company</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"VERY LARGE COMPANY"</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">SME</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="nf">dim</span><span class="p">()</span><span class="w">  </span><span class="c1"># 420</span><span class="w">


</span><span class="c1">######## ----------- save the final dataset ------ #######</span><span class="w">
</span><span class="n">fwrite</span><span class="p">(</span><span class="n">horbis_de</span><span class="p">,</span><span class="w"> </span><span class="s2">"./data/horbis_de.csv"</span><span class="p">)</span><span class="w">


</span><span class="c1">###</span><span class="w">
</span><span class="c1">###</span><span class="w">
</span><span class="c1">###</span><span class="w">
</span><span class="c1">### ----------- match with patent datasets ------ #######</span><span class="w">
</span><span class="n">han_names</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fread</span><span class="p">(</span><span class="s2">"./data/202208_HAN_NAMES.txt"</span><span class="p">)</span><span class="w">
</span><span class="n">han_person</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fread</span><span class="p">(</span><span class="s2">"./data/202208_HAN_PERSON.txt"</span><span class="p">)</span><span class="w">
</span><span class="n">han_patents</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fread</span><span class="p">(</span><span class="s2">"./data/202208_HAN_PATENTS.txt"</span><span class="p">)</span><span class="w">


</span><span class="nf">dim</span><span class="p">(</span><span class="n">horbis_de</span><span class="p">)</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">horbis_de</span><span class="p">)</span><span class="w">

</span><span class="c1"># function to clean string for patents</span><span class="w">
</span><span class="n">convert_string</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span><span class="w">

    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">%like%</span><span class="w"> </span><span class="s2">"aktiengesellschaft"</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"aktiengesellschaft"</span><span class="p">,</span><span class="w"> </span><span class="s2">"ag"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">

    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">%like%</span><span class="w"> </span><span class="s2">"electronic"</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"electronic"</span><span class="p">,</span><span class="w"> </span><span class="s2">"elect"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">

    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">%like%</span><span class="w"> </span><span class="s2">"and co kg"</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"and co kg"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">

    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">%like%</span><span class="w"> </span><span class="s2">"international"</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"international"</span><span class="p">,</span><span class="w"> </span><span class="s2">"int"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">

    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">%like%</span><span class="w"> </span><span class="s2">"technologies"</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"technologies"</span><span class="p">,</span><span class="w"> </span><span class="s2">"tech"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">

    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">%like%</span><span class="w"> </span><span class="s2">"technologie"</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"technologie"</span><span class="p">,</span><span class="w"> </span><span class="s2">"tech"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">

    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">%like%</span><span class="w"> </span><span class="s2">"engineering"</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"engineering"</span><span class="p">,</span><span class="w"> </span><span class="s2">"eng"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">

    </span><span class="nf">return</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">


</span><span class="n">horbis_de</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="o">:</span><span class="m">22</span><span class="p">)]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">horbisID</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">.I</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">cleaned_names</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">clean_strings</span><span class="p">(</span><span class="n">name</span><span class="p">)]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">cleaned_names</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">lapply</span><span class="p">(</span><span class="n">cleaned_names</span><span class="p">,</span><span class="w">
                                </span><span class="n">convert_string</span><span class="p">)]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">horbis_foo</span><span class="w">


</span><span class="n">han_names</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">Person_ctry_code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"DE"</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">patentID</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">.I</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[,</span><span class="w"> </span><span class="n">clean_name</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">clean_strings</span><span class="p">(</span><span class="n">Clean_name</span><span class="p">)]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">patent_foo</span><span class="w">


</span><span class="n">patent_match</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge_plus</span><span class="p">(</span><span class="n">data1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">horbis_foo</span><span class="p">,</span><span class="w"> </span><span class="n">data2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">patent_foo</span><span class="p">,</span><span class="w">
                        </span><span class="n">by.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"cleaned_names"</span><span class="p">,</span><span class="w"> </span><span class="n">by.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"clean_name"</span><span class="p">,</span><span class="w">
                        </span><span class="n">match_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"fuzzy"</span><span class="p">,</span><span class="w">
                        </span><span class="n">unique_key_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"horbisID"</span><span class="p">,</span><span class="w">
                        </span><span class="n">unique_key_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"patentID"</span><span class="p">)</span><span class="w">

</span><span class="nf">names</span><span class="p">(</span><span class="n">patent_match</span><span class="p">)</span><span class="w">
</span><span class="n">patent_match</span><span class="o">$</span><span class="n">match_evaluation</span><span class="w">

</span><span class="n">patent_match</span><span class="o">$</span><span class="n">matches</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">horbis_de_han</span><span class="w">

</span><span class="nf">names</span><span class="p">(</span><span class="n">horbis_de_han</span><span class="p">)</span><span class="w">

</span><span class="n">horbis_de_han</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">category_of_company</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"VERY LARGE COMPANY"</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">.</span><span class="p">[</span><span class="n">SME</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="nf">dim</span><span class="p">()</span><span class="w">  </span><span class="c1"># 283</span><span class="w">


</span><span class="c1">######## ----------- save the final dataset ------ #######</span><span class="w">
</span><span class="n">fwrite</span><span class="p">(</span><span class="n">horbis_de_han</span><span class="p">,</span><span class="w"> </span><span class="s2">"./data/horbis_de_han.csv"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

    </div>
    <div id='bibliography'>
        <div class='wrap'>
            <ol class="bibliography"></ol>
        </div>
    </div>
</div>
<!-- back-to-top button from Mkdocs material -->
<a
href="#"
id="back-top"
aria-label="Back-to-top link"
style="
position: fixed;
bottom: 10%;
margin-left:85%;
color: #808080;
background-color: #FFFFFF;"
hidden
>
<img width="30px" height="30px" alt="up-arrow" src="/images/up-arrow.png">
</a>

<script src="/assets/js/codeCopy.js"></script>
<script src="/assets/js/backTotop.js"></script>
<script>
    var lis = document.getElementsByClassName("footnotes")
    for (let i = 0; i < lis.length; i++){
        var li_tag = lis[i].getElementsByTagName('li')
    
        for (let j = 0; j < li_tag.length; j++) {
            li_tag[j].setAttribute('role', 'link')
        }
        var a_tag = lis[i].getElementsByTagName('a')
    
        for (let k = 0; k < a_tag.length; k++) {
            a_tag[k].setAttribute('role', 'link')
        }
    }
    </script>
    <style>
        .zoom-img{
            display: block;
            height: auto;
            transition: transform ease-in-out 0.7s;
            cursor: zoom-in;
        }
        .image-zoom-scale{
            transform: scale(1.7);
            cursor: zoom-out;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
            z-index: 100;
            position: relative;
        }
    </style>
    <script>
        document.querySelectorAll('.zoom-img').forEach(item => {
        item.addEventListener('click', function () {
            this.classList.toggle('image-zoom-scale');
        })
        });
    </script>
</body>
</html>